<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bash Commands</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Paul Rougieux</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-wrench"></span>
     
    Tools
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bash.html">Bash</a>
    </li>
    <li>
      <a href="communication.html">Communication</a>
    </li>
    <li>
      <a href="debian.html">Debian</a>
    </li>
    <li>
      <a href="docker.html">Docker</a>
    </li>
    <li>
      <a href="git.html">Git</a>
    </li>
    <li>
      <a href="lyx.html">Lyx</a>
    </li>
    <li>
      <a href="mysql.html">MySQL</a>
    </li>
    <li>
      <a href="postgresql.html">PostgreSQL</a>
    </li>
    <li>
      <a href="publish.html">Publish</a>
    </li>
    <li>
      <a href="python.html">Python</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="vim.html">Vim</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-microchip"></span>
     
    Algos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="clustering.html">Clustering</a>
    </li>
    <li>
      <a href="musical_scales.html">Musical scales</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="explore.html">Explore</a>
    </li>
    <li>
      <a href="datasources.html">Sources</a>
    </li>
  </ul>
</li>
<li>
  <a href="events.html">
    <span class="fa fa-users"></span>
     
    Events
  </a>
</li>
<li>
  <a href="publications.html">
    <span class="fa fa-book"></span>
     
    Publications
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Bash Commands</h1>

</div>


<pre class="r"><code>knitr::opts_chunk$set(eval=FALSE)</code></pre>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This page is the continuation of <a
href="https://paulremote.blogspot.de/2014/01/linux-shell-commands.html">my
blog post on GNU-Linux bash shell commands</a>.</p>
<p>Linux is the kernel of the operating system on top of which other
programs are built. A detailed list of GNU core utilities is available
under the command :</p>
<pre><code>info coreutils </code></pre>
<p>The page below also contains many commands from external tools that
are not part of the GNU project.</p>
<div id="environment-variables" class="section level2">
<h2>Environment variables</h2>
<p>Environment variables are the way the tell processes where resources
are located. For example</p>
<pre><code>export PYTHONPATH=&quot;$HOME/repos/biotrade/&quot;:$PYTHONPATH</code></pre>
<p>Tells python where the biotrade package is located.</p>
<p>PostGreSQL utilities <code>createuser</code> and
<code>createdb</code> can be told which port to use by specifying the
following environment variable beforehand:</p>
<pre><code>export PGPORT=5433</code></pre>
<p>The following variables can be used to specify a user and password
inside a postgresql docker container</p>
<pre><code>POSTGRES_USER=user_name
POSTGRES_PASS=password</code></pre>
</div>
</div>
<div id="command-history" class="section level1">
<h1>Command history</h1>
<p>To search within previous commands, press CTRL+R and start typing
words contained in the previous command.</p>
<p>If you accidentally press CTRL+S the <a
href="https://askubuntu.com/a/264253/315347">terminal will hang</a>
Press <code>CTRL+Q</code> to regain control. See also <a
href="https://unix.stackexchange.com/questions/72086/ctrl-s-hang-terminal-emulator">Ctrl-s
hang terminal emulator?</a> which provides a workaround: entering
<code>stty -ixon</code> in .bashrc.</p>
</div>
<div id="convert" class="section level1">
<h1>Convert</h1>
<p>This section is about converting from one document format into
another. For example converting a text file into a pdf file and
vice-versa.</p>
<div id="audio" class="section level2">
<h2>Audio</h2>
<p>Convert from Wav to mp3 <a
href="https://gist.github.com/championofblocks/3982727">seen in this
gist</a></p>
<pre><code>for i in *.WAV; do test -f &quot;${i%.WAV}.mp3&quot; || lame -b 320 -h &quot;${i}&quot; &quot;${i%.WAV}.mp3&quot;; done</code></pre>
</div>
<div id="clipboard" class="section level2">
<h2>Clipboard</h2>
<p><a
href="https://stackoverflow.com/questions/749544/pipe-to-from-the-clipboard-in-bash-script">Pipe
to from the clipboard in bash script</a></p>
<p>For example copy the readme file to the clipboard used by CTRL+C
CTRL+V:</p>
<pre><code>xclip -selection c README.md</code></pre>
</div>
<div id="pdf-to-images" class="section level2">
<h2>Pdf to images</h2>
<p><a
href="https://askubuntu.com/questions/50170/how-to-convert-pdf-to-image">How
to convert pdf to images</a></p>
<pre><code>cd ~/downloads
convert -density 150 input.pdf -quality 90 output.png</code></pre>
</div>
<div id="images-to-pdf" class="section level2">
<h2>Images to pdf</h2>
<p>Convert one or more images to pdf</p>
<pre><code>img2pdf img.jpg -o output.pdf </code></pre>
<p>Convert a directory of JPG images into a printable A4 pdf:</p>
<pre><code>img2pdf --output out.pdf --pagesize A4 --border 0cm:0cm *.JPG</code></pre>
<p>The help page <code>man img3pd</code> explains the arguments</p>
<blockquote>
<p>Convert a directory of JPEG images into a PDF with printable A4 pages
in <strong>landscape mode.</strong> On each page, the photo takes the
maximum amount of space while preserving its aspect ratio and a print
border of 2 cm on the top and bottom and 2.5 cm on the left and right
hand side.</p>
</blockquote>
<pre><code>img2pdf --output out.pdf --pagesize A4^T --border 2cm:2.5cm *.jpg</code></pre>
<blockquote>
<p>Appending ^T (a caret/circumflex followed by the letter T) turns the
paper size from portrait into land‐ scape.</p>
</blockquote>
<p>I used the following instruction to create an A4 page with 2 images
one jpg and one png</p>
<pre><code>img2pdf image1.jpg image2.png -o output.pdf --pagesize A4^T --border 1cm
img2pdf image1.jpg image2.png -o output.pdf --pagesize A4 --border 1cm
img2pdf *.jpg -o output.pdf --pagesize A4 --border 1cm</code></pre>
<p>Interestingly when I asked for landscape mode, only the second image
appeared in landscape. When I asked for portrait mode, only the second
image appeared in portrait mode. The first jpg image contained exif
orientation metadata (it was rotated vertically). Opening the first
image in Gimp, rotating it and exporting it under a new name (without
the exif metadata) solves the issue. Both pages are portrait A4.</p>
<p>Convert <a
href="https://stackoverflow.com/questions/8955425/how-can-i-convert-a-series-of-images-to-a-pdf-from-the-command-line-on-linux">all
jpg images in the current directory</a> to a pdf</p>
<pre><code>img2pdf $(find . -iname &#39;*.jpg&#39; | sort -V) -o ./document.pdf  </code></pre>
<p>If there is an alpha layer in the image, it will not be added to the
pdf. The Warning message suggests using imagemagick to remove the alpha
layer.</p>
<pre><code>WARNING:root:Image contains transparency which cannot be retained in PDF.
WARNING:root:img2pdf will not perform a lossy operation.
WARNING:root:You can remove the alpha channel using imagemagick:
WARNING:root:  $ convert input.png -background white -alpha remove -alpha off output.png
ERROR:root:error: Refusing to work on images with alpha channel</code></pre>
<div id="images-from-a-zip-folder-to-a-pdf-document"
class="section level3">
<h3>Images from a zip folder to a pdf document</h3>
<p>Unzip the archive containing jpeg images into a temporary folder,
reduce the image sizes to 2000 pixel wide and generate a pdf.</p>
<pre><code>mkdir -p /tmp/bli/newfolder
cd /tmp/bli/
unzip ~/downloads/fwdbungenfrfrderunterrichtfrdienchstenstunden.zip
mogrify -resize 2000 -path ./newfolder *.jpeg
cd newfolder/
img2pdf *.jpeg -o output.pdf --pagesize A4 --border 1cm
echo &quot;The pdf document containing all images is located at: /tmp/bli/output.pdf&quot;</code></pre>
</div>
</div>
<div id="images-to-other-formats" class="section level2">
<h2>Images to other formats</h2>
<p>Convert a png image to a jpgeg image</p>
<pre><code>convert canto_dei_sanfedisti.png canto_dei_sanfedisti.jpg</code></pre>
<p>Convert a png image with an alpha layer to an image without alpha
layer</p>
<pre><code>convert input.png -background white -alpha remove -alpha off output.png</code></pre>
<p>Convert from png to jpg and change size</p>
<pre><code>mogrify -resize 2000 -path ./newfolder -format jpg *.png</code></pre>
<p>Only change format</p>
<pre><code>mogrify  -path ./newfolder -format jpg *.png</code></pre>
<p>See also more image modification commands in the edit image files
section below.</p>
</div>
<div id="pandoc-convert-documents-between-various-formats"
class="section level2">
<h2>Pandoc convert documents between various formats</h2>
<p><a href="https://pandoc.org/demos.html">Pandoc demos</a> contains a
lot of example commands to convert text files from one format to
another. <a href="https://pandoc.org/MANUAL.html">Pandoc user
guide</a></p>
<p>Convert a markdown document to pdf</p>
<pre><code>pandoc filname.md -o filename.pdf
# If there are utf-8 encoding issues, use another engine
pandoc readings_jrc.md -o readings_jrc.pdf --pdf-engine=xelatex</code></pre>
<p>Convert a markdown document to pptx</p>
<pre><code>pandoc filname.md -o filename.pptx</code></pre>
<p>Convert an odt document to markdown</p>
<pre><code>pandoc filename.odt -o filename.md </code></pre>
<p>Convert a Microsoft Word document to markdown</p>
<pre><code>pandoc filename.docx -o filename.md </code></pre>
<p>Convert a Microsoft Word document to markdown and keep images</p>
<pre><code>pandoc --extract-media figures input.docx -o output.md</code></pre>
<p>Images are contained in a <code>media</code> subfolder in Word
documents, the instruction above leads to a <code>figure/media</code>
sub folder. To avoid this <a
href="https://stackoverflow.com/a/52593892/2641825">use the current
directory path</a></p>
<pre><code>pandoc --extract-media=. input.docx -o output.md</code></pre>
<p>Convert an html code snippets to markdown and display the output at
the command line</p>
<pre><code>echo &quot;Link: &lt;a href=&quot;https://www.linphone.org/&quot;&gt;Linphone&lt;/a&gt;&quot;| pandoc -f html -t markdown
# Link: [Linphone](https://www.linphone.org/)</code></pre>
<p>Convert an entire web page to markdown</p>
<pre><code>pandoc https://pandoc.org/help.html -t markdown</code></pre>
<p><a href="https://pandoc.org/MANUAL.html#headers">Markdown has two
different header styles</a> The default is to use setext-style headers
for levels 1-2, and then ATX headers. To use ATX style headers only in
markdown output:</p>
<pre><code>pandoc --atx-headers filename.docx -o filename.md </code></pre>
<div id="yaml-front-matter-for-styles" class="section level3">
<h3>Yaml front matter for styles</h3>
<div id="bibliography" class="section level4">
<h4>Bibliography</h4>
<p>Custom yaml front matter for a markdown document that contains
reading notes with citations. See also the vim.Rmd document on pandoc
bibliographies.</p>
<pre><code>---
title: Reading notes
author: Paul Rougieux
bibliography: /home/paul/rp/bioeconomy_papers/bibliography/jrc_ispra.bib
abstract: Reading notes at the JRC
header-includes: |
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    \fancyhead[CO,CE]{Reading notes}
    \fancyfoot[CO,CE]{JRC}
    \fancyfoot[LE,RO]{\thepage}
---
\tableofcontents{}
...file content... this is probably not the way to do it    
\bibliography{../bibliography/jrc_ispra}
\bibliographystyle{apalike}</code></pre>
<p>This is probably not the way to do it, the bibliography should be
included in the pandoc call? Note this requires citeproc</p>
<pre><code>sudo apt install pandoc-citeproc</code></pre>
<p>Then this should work :</p>
<pre><code>pandoc readings_jrc.md -o readings_jrc.pdf --pdf-engine=xelatex --bibliography=jrc_ispra.bib</code></pre>
<p>There is still an issue with the encoding of the bibliography.</p>
</div>
<div id="paper-size-and-margins" class="section level4">
<h4>Paper size and margins</h4>
<p>Change the margin to 0.5 cm</p>
<pre><code>---
title: &quot;Songs of freedom&quot;
author: &quot;Bob Marley&quot;
geometry: margin=0.5cm
---</code></pre>
<p>A4 paper</p>
<pre><code>---
title: LETTERA
papersize: A4
---</code></pre>
</div>
<div id="font-size" class="section level4">
<h4>Font size</h4>
<p>Change the font to 12pt, the max available in the default
template.</p>
<pre><code>---
fontsize: 12pt
---</code></pre>
<p>To get bigger fonts (up to 20pt) as explained in this <a
href="https://stackoverflow.com/a/46055046">SO answer</a>, you can use
the <code>extsizes</code> package by adding
<code>documentclass: extarticle</code>.</p>
</div>
<div id="page-numbers" class="section level4">
<h4>Page numbers</h4>
<p>Adding headers and footers to pandoc suggests using:</p>
<pre><code>---
title: Test
author: Author Name
header-includes: |
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    \fancyhead[CO,CE]{This is fancy}
    \fancyfoot[CO,CE]{So is this}
    \fancyfoot[LE,RO]{\thepage}
abstract: This is a pandoc test . . . 
---</code></pre>
</div>
<div id="table-of-content" class="section level4">
<h4>Table of content</h4>
<p>Add a table of content at the beginning of the document</p>
<pre><code>---
title: &quot;Work plan&quot;
geometry: margin=2cm
toc: yes
---</code></pre>
<p>When specified in the yaml front matter only, the table of content
appears in pdf output but not in html output. This may be due to a
difference in the latex and html templates? Display the content of the
latex and html templates</p>
<pre><code>pandoc -D latex
pandoc -D html</code></pre>
<p>However calling the –toc argument does create a table of content in
the html file:</p>
<pre><code>pandoc -s --toc notes.md -o notes.html</code></pre>
</div>
<div id="two-column-layout-and-class-options" class="section level4">
<h4>Two column layout and class options</h4>
<p>The <code>openany</code> option for the book document class, allows
opening a chapter on any page left or right, otherwise the book class
forces chapter opening on the left page only and inserts a blank
page.</p>
<pre><code>---
title: &quot;Songs&quot;
geometry: margin=0.5cm
documentclass: book
classoption:
- twocolumn
- openany
---</code></pre>
</div>
</div>
<div id="bash-script-for-bulk-conversion" class="section level3">
<h3>Bash script for bulk conversion</h3>
<p>Convert many markdown files with this <a
href="https://github.com/FHefner/pandoc-docs/blob/master/pandoc-docs">bash
script for pandoc</a></p>
<pre><code>for mdfile in *.md; do
pdffile=${mdfile%.md}.pdf
echo $pdffile
done</code></pre>
<p>Convert all docx documents to markdown in the current folder</p>
<pre><code>for docxfile in *.docx; do
mdfile=${docxfile%.docx}.md
echo &quot;converting $docxfile to $mdfile&quot;
pandoc &quot;$docxfile&quot; -o &quot;$mdfile&quot;
done</code></pre>
<p>Pandoc can convert to PDF, but not from PDF.</p>
<p>You can also create template files as explained in super user <a
href="https://superuser.com/questions/356032/markdown-to-latex-conversion-with-a-custom-preamble-using-pandoc/356044#356044">markdown
to latex conversion with a custom preamble</a></p>
<p>See also the makefile for pandoc in the programming with bash /
makefile section below.</p>
</div>
</div>
<div id="pdf-to-text-with-pdfminer" class="section level2">
<h2>Pdf to text with pdfminer</h2>
<p>(pdfminer](<a href="https://github.com/pdfminer/pdfminer.six"
class="uri">https://github.com/pdfminer/pdfminer.six</a>) Convert all
pdf documents to text files in the current folder:</p>
<pre><code>for pdffile in *.pdf; do
txtfile=${pdffile%.pdf}.txt
echo &quot;converting $pdffile to $txtfile&quot;
pdf2txt.py $pdffile &gt; $txtfile
done</code></pre>
<p>See also a utility to extract tables from pdf documents.</p>
</div>
<div id="pdf-to-tables-with-tabula" class="section level2">
<h2>Pdf to tables with tabula</h2>
<p>Extract tables from a pdf with <a
href="https://tabula.technology/">tabula</a></p>
<pre><code>cd /home/paul/Downloads/tabula-jar-1.2.1/tabula
java -Dfile.encoding=utf-8 -Xms256M -Xmx1024M -jar tabula.jar</code></pre>
<p>Then visit <a href="http://127.0.0.1:8080/"
class="uri">http://127.0.0.1:8080/</a></p>
</div>
<div id="ascii-art" class="section level2">
<h2>ASCII art</h2>
<p>Convert text to large ascii art</p>
<pre><code>figlet</code></pre>
</div>
</div>
<div id="count" class="section level1">
<h1>Count</h1>
<div id="number-of-files" class="section level2">
<h2>Number of files</h2>
<p>Count the number of files in the current folder</p>
<pre><code>ls |wc -l</code></pre>
<p><a href="https://askubuntu.com/a/370717/315347">Recursively count the
number of files in a directory</a>, limiting the maximum depth</p>
<pre><code>find -maxdepth 1 -type f | wc -l</code></pre>
<p>Counting files with a specific extension</p>
<pre><code>find -name &#39;*.csv&#39; |wc -l
find -name &#39;*.ogg&#39; |wc -l</code></pre>
<p><a href="https://stackoverflow.com/a/9157162/2641825">Recursively
counting files</a></p>
<pre><code>find DIR_NAME -type f | wc -l</code></pre>
</div>
<div id="number-of-lines-in-a-text-file" class="section level2">
<h2>Number of lines in a text file</h2>
<p>Count the number of lines in a file</p>
<pre><code>wc -l filename.txt </code></pre>
<p>Count the number of lines in all files, and give the total line
count.</p>
<pre><code>find . -name &#39;*.py&#39; | xargs wc -l # python code
find . -name &#39;*.R&#39; | xargs wc -l # R code</code></pre>
</div>
</div>
<div id="dos" class="section level1">
<h1>DOS</h1>
<p>Here are some DOS commands because sometimes you need to work on
windows.</p>
<p>Remove directories recursively</p>
<pre><code>rmdir /S </code></pre>
<p>Show environmental variables</p>
<pre><code>echo %Path%</code></pre>
</div>
<div id="dot-files" class="section level1">
<h1>Dot files</h1>
<div id="alias" class="section level2">
<h2>Alias</h2>
<pre><code>alias ll=&quot;ls -lh&quot; </code></pre>
<p>Based on how can i sort du-h output by size</p>
<pre><code>alias du=&#39;du -hd1 | sort -h -r&#39;</code></pre>
<p>You can place those commands in your ~/.bashrc to create a permanent
alias. bashrc:</p>
<blockquote>
<p>“You may want to put all your additions into a separate file like
~/.bash_aliases, instead of adding them here directly.”</p>
</blockquote>
<p>Alias from other persons:</p>
<p><a href="https://github.com/statox/dotfiles/blob/master/bash_aliases"
class="uri">https://github.com/statox/dotfiles/blob/master/bash_aliases</a></p>
<p>Reload bash aliases:</p>
<pre><code>source ~/.bashrc</code></pre>
</div>
<div id="profile-.bash_profile-and-.bashrc" class="section level2">
<h2>Profile .bash_profile and .bashrc</h2>
<p>These are places where a user can turn of the system BEEP :</p>
<pre><code>setterm -blength 0</code></pre>
<p>.bash_profile is executed on login shell, when you login in another
tty or when you access a system through ssh. .bashrc is executed on
non-login shells when you open a terminal window in Gnome.</p>
<p>Debian Dotfiles</p>
<pre><code>&quot;Now, since bash is being invoked as a login shell (with name &quot;-bash&quot;, a special ancient hack), it reads /etc/profile first. Then it looks in your home directory for .bash_profile, and if it finds it, it reads that.&quot;

[...] &quot;You may have noted that .bashrc is not being read in this situation. You should therefore always have command source ~/.bashrc at the end of your .bash_profile in order to force it to be read by a login shell.  &quot;</code></pre>
<p>In .bashrc a user can set environment variables, define alias (see
above).</p>
</div>
</div>
<div id="download" class="section level1">
<h1>Download</h1>
<div id="download-with-curl" class="section level2">
<h2>Download with Curl</h2>
<p>Curl man page:</p>
<blockquote>
<p>“curl is a tool to transfer data from or to a server, using one of
the supported protocols (DICT, FILE, FTP, FTPS, GOPHER, HTTP, HTTPS,
IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMB, SMBS,
SMTP, SMTPS, TELNET and TFTP). The command is designed to work without
user interaction.”</p>
</blockquote>
<p>The “remote-name” argument or capital “-O” loads a file from a URL,
using the file name from the URL as explained in the curl man page.</p>
<blockquote>
<p>” -O, –remote-name Write output to a local file named like the remote
file we get. (Only the file part of the remote file is used, the path is
cut off.)”</p>
</blockquote>
<pre><code>curl -O &lt;url_including_a_file_name&gt;</code></pre>
</div>
<div id="download-videos-and-audio" class="section level2">
<h2>Download videos and audio</h2>
<p>Install youtube-dl using pip:</p>
<pre><code> sudo pip install --upgrade youtube_dl</code></pre>
<p>You may also need to install the ffmpeg package:</p>
<pre><code>sudo apt-get install ffmpeg</code></pre>
<p>Download a video from youtube :</p>
<pre><code>youtube-dl video_url</code></pre>
<p>Download in a small format below 480 pixel height:</p>
<pre><code>youtube-dl  -f &#39;bestvideo[height&lt;=480]+bestaudio/best[height&lt;=480]&#39; https://www.youtube.com/watch?v=YAtLTLiqNwg</code></pre>
<p>The repetition of the hight in the audio part is needed, otherwise,
there will be no sound.</p>
<p>Download only the audio in an OGG Vorbis format</p>
<pre><code>youtube-dl --extract-audio --audio-format vorbis video_url</code></pre>
<p>Download only the audio in an .mp3 format</p>
<pre><code>youtube-dl --extract-audio --audio-format mp3 video_url</code></pre>
<p>Create bash aliases to download various audio formats from
youtube</p>
<pre><code>alias youtubevorbis=&quot;youtube-dl --extract-audio --audio-format vorbis&quot;
alias youtubemp3=&quot;youtube-dl --extract-audio --audio-format mp3&quot;</code></pre>
<p>If you encounter some Errors 403 forbidden, removing the cache might
help</p>
<p><a
href="https://stackoverflow.com/questions/32104702/youtube-dl-library-and-error-403-forbidden-when-using-generated-direct-link-by">error
403 with youtube-dl</a></p>
<pre><code>youtube-dl --rm-cache-dir</code></pre>
<p>You can also download multiple URLs from a batch file:</p>
<blockquote>
<p>-a, –batch-file FILE</p>
<p>File containing URLs to download (‘-’ for stdin), one URL per line.
Lines starting with ‘#’, ‘;’ or ‘]’ are considered as comments and
ignored.</p>
</blockquote>
<p>Download in a lower resolution (copied from example in man
<code>youtube-dl</code>)</p>
<pre><code>youtube-dl -f &#39;bestvideo[height&lt;=480]+bestaudio/best[height&lt;=480]&#39; --extract-audio --audio-format vorbis --sleep-interval 30 -i --batch-file /tmp/dl.md</code></pre>
<p>Download only audio (using a low resolution for the video which is
dropped)</p>
<pre><code>youtube-dl -f &#39;bestaudio/best[height&lt;=480]&#39; --extract-audio --audio-format vorbis --sleep-interval 30 -i --batch-file /tmp/dl.md</code></pre>
</div>
<div id="parse-html-files-for-urls" class="section level2">
<h2>Parse html files for URLS</h2>
<p><a
href="https://unix.stackexchange.com/questions/181254/how-to-use-grep-and-cut-in-script-to-obtain-website-urls-from-an-html-file">How
to use grep and cut in script to obtain website URLs from an HTML
file</a> Nice examples such as this one with decomposition</p>
<pre><code>grep -Eoi &#39;&lt;a [^&gt;]+&gt;&#39; source.html |
grep -Eo &#39;href=&quot;[^\&quot;]+&quot;&#39; | 
grep -Eo &#39;(http|https)://[^/&quot;]+&#39;</code></pre>
<p>and this one which extracts all top level domain present in an html
page</p>
<pre><code>cat urls.html | grep -Eo &quot;(http|https)://[a-zA-Z0-9./?=_-]*&quot; | sort -u</code></pre>
<p>This is how I extracted all links from an html file:</p>
<pre><code>grep -Eo &#39;(http|https)://[^&quot;]+&#39; Musicwelistento.html | sed -e  &#39;s/https:\/\/www.google.com\/url?q=//g&#39; &gt; song_links.txt</code></pre>
</div>
</div>
<div id="edit" class="section level1">
<h1>Edit</h1>
<div id="edit-image-files" class="section level2">
<h2>Edit Image files</h2>
<div id="resize" class="section level3">
<h3>Resize</h3>
<p>Resize a picture to 2000 px wide using ImageMagick:</p>
<pre><code>convert picture1.jpg -resize 2000 picture2.jpg </code></pre>
<p>Resize a picture to 2000 px wide and also convert it to gray
scale:</p>
<pre><code>convert picture1.jpg -resize 2000 -type Grayscale picture2.jpg </code></pre>
<p>Batch processing, resize all jpg images and place the resized images
in a new folder</p>
<pre><code>mkdir small
mogrify -resize 2000 -path ./small *.jpg
mogrify -resize 2000 -path ./small *.jpeg
mogrify -resize 2000 -path ./small/ *.JPG
mogrify -resize 2000 -type Grayscale -path ./small *.jpg</code></pre>
</div>
<div id="convert-1" class="section level3">
<h3>Convert</h3>
<p>Convert to different color scheme, other file format or rotate
images. For example to convert from png to jpg and change size</p>
<pre><code>mogrify -resize 2000 -path ./newfolder -format jpg *.png</code></pre>
<p>Convert to <a
href="http://www.imagemagick.org/discourse-server/viewtopic.php?t=11279">black
and white</a> (tricky to get the threshold right):</p>
<pre><code>convert picture1.jpg -threshold 40% picture2.jpg </code></pre>
<p>Other option to convert to black and white <a
href="https://superuser.com/questions/75373/convert-color-photos-of-documents-to-good-black-and-white-bitonal-images">good
black and white bimodal images</a>:</p>
<pre><code>convert -monochrome in.png out.png</code></pre>
<p>Note this doesn’t result in smaller images. To get smaller files, set
the <code>-quality</code> parameter to a value between 1 and 100.</p>
</div>
<div id="rotate" class="section level3">
<h3>Rotate</h3>
<p>Batch processing, rotate all images clockwise or counter
clockwise</p>
<pre><code>mogrify -rotate 90 ../small/ *.JPG
mogrify -rotate 270 ../small/ *.JPG</code></pre>
<p>Error: “cache resources exhausted” can appear in conversion of large
images.</p>
<pre><code>sudo find / -name &quot;policy.xml&quot;</code></pre>
<p><a
href="https://stackoverflow.com/questions/31407010/cache-resources-exhausted-imagemagick">SO
explanation</a> Edit the file as super user</p>
<pre><code>sudo vim /etc/ImageMagick-6/policy.xml</code></pre>
<p>Change</p>
<p><policy domain="resource" name="disk" value="1GiB"/></p>
<p>to</p>
<p><policy domain="resource" name="disk" value="4GiB"/></p>
</div>
<div id="a4-portrait-scan-emulation" class="section level3">
<h3>A4 portrait Scan emulation</h3>
<p>Combine some of the commands above to create a scanned A4 portrait
pdf document from pictures taken from a camera. First reduce the size of
the pictures to 2000 pixel wide and rotate them 90 degrees, then combine
all images in a pdf. Use a higher compression for smaller image sizes.
You might need to change the rotation from -90 to 90 depending on how
the camera was held.</p>
<pre><code>mkdir small
mogrify -resize 2000 -quality 40 -rotate -90 -path ./small/ *.JPG
cd small/
img2pdf --output out.pdf --pagesize A4 --border 0cm:0cm *.JPG</code></pre>
<p>Remove the -quality argument to keep default higher quality
images.</p>
<pre><code>mogrify -resize 2000 -rotate 90 -path ./small/ *.JPG</code></pre>
<p>Use only the quality argument without rotation</p>
<pre><code>mogrify -quality 40 -path ./small/ *.JPG</code></pre>
</div>
</div>
<div id="edit-music-files" class="section level2">
<h2>Edit music files</h2>
<p><a
href="https://askubuntu.com/questions/664698/mp3-tags-from-file-names">Mp3
tags from file names</a> <a
href="https://pypi.org/project/tagpy/#history">tagpy</a></p>
<div id="crop-or-trim-music-files" class="section level3">
<h3>Crop or trim music files</h3>
<p>Cut or crop a music file, to start only from the 6th second</p>
<pre><code>ffmpeg -i hungarian_dance.ogg -ss 6 -c copy file-2.ogg</code></pre>
<p>Stack exchange question <a
href="https://unix.stackexchange.com/q/182602/85530">trim audio file
using start and stop times</a></p>
<pre><code>ffmpeg -i file.mkv -ss 20 -to 40 -c copy file-2.mkv
ffmpeg -i file.mkv -ss 00:00:20 -to 00:00:40 -c copy file-2.mkv</code></pre>
</div>
</div>
<div id="edit-pdf-files" class="section level2">
<h2>Edit PDF files</h2>
<div id="combine-pdf" class="section level3">
<h3>Combine PDF</h3>
<p>Commands based on the poppler library for PDF manipulation. Merge
multiple PDF into one:</p>
<pre><code>pdfunite in-1.pdf in-2.pdf in-n.pdf out.pdf</code></pre>
<p>Alternatively, pdftk can be used to merge PDF files</p>
<pre><code>pdftk input1.pdf input2.pdf cat output output.pdf</code></pre>
<p><a href="https://askubuntu.com/a/282455/315347">Extract pages from a
pdf</a></p>
<pre><code>pdftk full-pdf.pdf cat 12-15 output outfile_p12-15.pdf</code></pre>
<p>Also works with several distant groups of pages</p>
<pre><code>pdftk Accordeon-facile-Volume-3.pdf cat 10-11 14-17 30 output la_java_bleue.pdf</code></pre>
</div>
<div id="split-pdf" class="section level3">
<h3>Split PDF</h3>
<p>Split a pdf in two</p>
<pre><code>mutool poster -x 2 cbmflow.pdf output.pdf
# if necessary, install mutool with 
apt install mupdf-tools</code></pre>
</div>
</div>
<div id="replace-strings-in-text-files" class="section level2">
<h2>Replace strings in text files</h2>
<p>Replace strings</p>
<pre><code>first=&quot;I love Suzy and Mary&quot;
second=&quot;Sara&quot;
first=${first/Suzy/$second}</code></pre>
<p>Replace strings with sed</p>
<pre><code>sed -i  &#39;s/pattern/replacement/g&#39; bli.txt 

sed -i  &#39;s/^.*\://g&#39; input_file.txt # edit file in place
grep EMAIL input_file.txt |sed  &#39;s/^.*\://g&#39; &gt; output_file.txt </code></pre>
<p>Add a line above and below a line that contains a particular string.
This was necessary for a Latex to Lyx document conversion. The Latex
file had problematic characters in href links. Conversion worked fine
without the href links, to keep the links</p>
<p>I quoted them in <code>\begin{verbatim}</code> statements. <a
href="https://stackoverflow.com/a/24230154/2641825">sed add # before a
line containing a pattern</a> <a
href="https://unix.stackexchange.com/questions/97428/sed-how-to-do-several-consecutive-substitutions-but-process-file-only-once">sed
performing several substitutions</a></p>
<pre><code># Test output to stdout placing # before and after a matching line
sed -e /href/s/^/\\n#\\n/ -e /href/s/$/\\n#\\n/ clipboard_3_to_delete.tex| grep -C2 href </code></pre>
<div id="modify-the-file-in-place" class="section level3">
<h3>Modify the file in place</h3>
<p>Both of these work</p>
<pre><code>cd /tmp
cat &quot;Export Quantity&quot; &gt;&gt; file.md

bli () {
perl -i&#39;&#39; -pi -e &quot;s/$1/$2/g&quot; file.md
}
bli &quot;Export Quantity&quot; &quot;export_quantity&quot;

bla () {
perl -i&#39;&#39; -pE &quot;s/$1/$2/g&quot; file.md
}
bla &quot;Export Quantity&quot; &quot;export_quantity&quot;</code></pre>
</div>
</div>
<div id="remove-duplicated-lines-from-a-file" class="section level2">
<h2>Remove duplicated lines from a file</h2>
<pre><code>awk &#39;!a[$0]++&#39; input.txt </code></pre>
</div>
<div id="select-an-editor" class="section level2">
<h2>Select an editor</h2>
<p>To choose your preferred text editor, used for example by
<code>crontab -e</code>, run:</p>
<pre><code>select-editor</code></pre>
</div>
</div>
<div id="events" class="section level1">
<h1>Events</h1>
<div id="calendar" class="section level2">
<h2>Calendar</h2>
<p>Reddit <a
href="https://www.reddit.com/r/commandline/comments/iupqui/github_command_line_app_10_launched/">CLI
calendar applications</a></p>
<ul>
<li><a href="https://calcurse.org/">calcurse</a> github page: <a
href="https://github.com/lfos/calcurse">calcurse</a></li>
<li><a href="https://github.com/itchyny/calendar.vim">calendar.vim</a>,
only Google cal no CalDAV support <a
href="https://github.com/itchyny/calendar.vim/issues/133">issue
133</a></li>
<li><a href="https://lostpackets.de/khal/">khal</a></li>
</ul>
</div>
<div id="cron" class="section level2">
<h2>Cron</h2>
<p>In order to <a
href="https://unix.stackexchange.com/questions/41496/two-different-etc-hosts-depending-upon-the-time">use
two differet /etc/hosts depending upon the time</a>, I added the
following to /etc/hosts_worktime:</p>
<pre><code>0.0.0.1 www.youtube.com
0.0.0.1 youtube.com</code></pre>
<p>I then created a cron job that copies that files to /etc/hosts at
9am. Start the crontab editor:</p>
<pre><code>crontab -e</code></pre>
<p>Add these lines:</p>
<pre><code>0  9 * * 1-5 ln -f /etc/hosts_worktime /etc/hosts
0 17 * * 1-5 ln -f /etc/hosts_playtime /etc/hosts</code></pre>
<p>I initially used <code>cp</code> instead of <code>ln -f</code>, but
it’s better to make a hard link so any subsequent modification of
/etc/hosts will actually be kept in one of the file, and not overwritten
by the <code>cp</code>. I noticed that youtube.com was still available
for a little while after I blocked it. I’m not sure it’s necessary or if
you simply need to wait a little bit for the change to the hosts file to
take effect. Anyway here is an instruction to restart networking and
clear the DNS cache:</p>
<pre><code>sudo /etc/init.d/networking restart</code></pre>
</div>
<div id="to-do-lists" class="section level2">
<h2>To do lists</h2>
<p><a
href="https://taskwarrior.org/docs/best-practices.html">Taskwarrior</a></p>
<p>To add a small unit of work in the Kitchen project:</p>
<pre><code>task add project:Kitchen Select floor tiles</code></pre>
</div>
</div>
<div id="find" class="section level1">
<h1>Find</h1>
<div id="find-files" class="section level2">
<h2>Find files</h2>
<p>Find files in subdirectories of the current directory (Quotes are
requited to prevent shell command expansion). Find files of a specific
extension:</p>
<pre><code>find -name &quot;*.pdf&quot; </code></pre>
<p>Like -name, but the match is case insensitive</p>
<pre><code>find -iname &quot;*phd*&quot;</code></pre>
<p>Find files of a specific modification time:</p>
<pre><code>find . -mtime 0 # modified in the last 24 hours</code></pre>
<p>Find files <a
href="https://stackoverflow.com/questions/1341467/find-filenames-not-ending-in-specific-extensions-on-unix">not
having a specific extension</a>:</p>
<pre><code>find . -type f -not -name &#39;*.csv&#39;
# Alternative syntax
find . -type f ! \( -name &#39;*.csv&#39; \)</code></pre>
<p>Limit the depth of the search</p>
<pre><code>find . -maxdepth 1 -name &quot;*.pdf&quot; </code></pre>
<p>Find files in the whole system</p>
<pre><code>locate filename</code></pre>
<div id="show-the-beginning-of-many-files" class="section level3">
<h3>Show the beginning of many files</h3>
<p>To show the beginning of many files in a hierarchy:</p>
<pre><code>head $(find -name *.csv)</code></pre>
</div>
</div>
<div id="get-information-about-a-file" class="section level2">
<h2>Get information about a file</h2>
<p>Determine file type and encoding. The -i option shows the mime type
strings.</p>
<pre><code>file filename
file -i filename</code></pre>
<p>list a directory</p>
<pre class="bash"><code>ls
ls -R # list subdirectories recursively
ls -lh # sizes in human readable format</code></pre>
<p>Display the <a
href="https://stackoverflow.com/questions/16391208/print-a-files-last-modified-date-in-bash">last
modification date of a file</a></p>
<pre><code>date -r &lt;filename&gt;
ls -l &lt;filename&gt;</code></pre>
<p>More file information</p>
<pre><code>stat &lt;filename&gt;</code></pre>
</div>
<div id="search-and-filter-text-files" class="section level2">
<h2>Search and filter text files</h2>
<p>Search with Grep</p>
<pre><code>grep &quot;text&quot; file.txt</code></pre>
<p>Recursive search (-r) in all files in the directory for a given
pattern, case insensitive (-i)</p>
<pre><code>grep -ri &quot;pattern&quot; .</code></pre>
<p>Give 1 line of context before and 2 lines of context after:</p>
<pre><code>grep -B 1 -A 2 pattern README.md</code></pre>
<p>Search for lines containing “Done” or “encountered” only in specific
log files recursively in a directory. Also displays the line count at
the end.</p>
<pre><code>grep -r Done --include runner.log | tee /dev/tty |wc -l
grep -r encountered --include runner.log | tee /dev/tty |wc -l</code></pre>
<p>Note: <a
href="https://stackoverflow.com/questions/5677201/how-to-pipe-stdout-while-keeping-it-on-screen-and-not-to-a-output-file">How
to pipe stdout while keeping it on screen</a></p>
<p>Show all csv files mentioned in a source code (supposing the csv file
name contain only alphanumeric characters). Use Extended regular
expression (-E) to search for alphanumeric characters, only show the
matching result (-o), not the full line and show the line number (-n)
where the string occurs:</p>
<pre><code>grep -Eon &quot;[[:alnum:]]+.csv&quot; file.txt</code></pre>
<p>Count occurrences of a word in a file</p>
<pre><code>grep -roh word filename.txt  | wc -w</code></pre>
<p><a href="http://www.grymoire.com/Unix/Awk.html#uh-11">Awk
tutorial</a>, for example filter a large file for lines that have a
third field (product code) starting with 44, keep the header line:</p>
<pre><code>awk -F, &#39;$3 ~ /^44/||NR==1&#39; nc201501.dat|less</code></pre>
<p>Regexp match beginning of and end of line with ^ and $.</p>
<p>Follow the end of a log file as it is written</p>
<pre><code>tail -f</code></pre>
<p>See tab and end of line characters in a text file</p>
<pre><code>cat -te filename |less </code></pre>
</div>
<div id="search-in-pdf-files" class="section level2">
<h2>Search in pdf files</h2>
<p>Search a text pattern in all PDF files present in a directory:</p>
<pre><code>pdfgrep pattern *.pdf</code></pre>
</div>
<div id="look-at-lines-of-a-text-file-with-less" class="section level2">
<h2>Look at lines of a text file with less</h2>
<p>Less and vim can handle very large text files (several Gb). Go to a
specific line using less</p>
<pre><code>&lt;line number&gt;g</code></pre>
<p>To display line numbers in less</p>
<pre><code>-N</code></pre>
<p>Go to a specific line using vim</p>
<pre><code>:&lt;line number&gt;</code></pre>
<p>To display line numbers in vim</p>
<pre><code>:set nu</code></pre>
</div>
</div>
<div id="list-files" class="section level1">
<h1>List files</h1>
<p>List all files in a directory</p>
<pre><code>ls</code></pre>
<p>List a file with its full directory path</p>
<pre><code>realpath README.md
ls -ld $PWD
ls -ld ~/downloads/*</code></pre>
<p>To include dot files, pipe the output of <code>ls -a</code> to
realpath:</p>
<pre><code>ls -a | xargs realpath</code></pre>
<p>To list subdirectories recursively:</p>
<pre><code>ls -aR | xargs realpath</code></pre>
<p>In case of you have spaces in file names, xargs recomments using the
<code>-o</code> option to prevent file names from being processed
incorrectly, this works best with the output of
<code>find -print0</code> and it starts to look a lot more complex than
other answers:</p>
<pre><code>find -print0 |xargs -0 realpath</code></pre>
<p>The above is an <a
href="https://stackoverflow.com/a/65002323/2641825">answer</a> I posted
on Stackoverflow. See also a Unix and Linux stackexchange <a
href="https://unix.stackexchange.com/questions/268474/how-to-list-all-files-in-a-directory-with-absolute-paths">question
on how to list all files in a directory with absolute path</a>.</p>
<div id="tree" class="section level2">
<h2>Tree</h2>
<p>List contents of a directories in a tree like format</p>
<pre><code>tree
tree -d # List directories only, no files</code></pre>
<p>Ignore files that contain compiled python bytecode with the
<code>-I</code> option</p>
<pre><code>tree -I &quot;*.pyc&quot;</code></pre>
<p>Show only python file matching the <code>"*.py"</code> pattern with
the <code>-P</code> option</p>
<pre><code>tree -P &quot;*.py&quot;</code></pre>
</div>
</div>
<div id="networking" class="section level1">
<h1>Networking</h1>
<div id="show-ip-addresses" class="section level2">
<h2>Show IP addresses</h2>
<p>Show the IP address</p>
<pre><code>ip addr show</code></pre>
<p>Show the state of network interfaces</p>
<pre><code>ip link</code></pre>
</div>
<div id="check-ports" class="section level2">
<h2>Check ports</h2>
<p>Check open ports on a system</p>
<pre><code>nmap -Pn &lt;hostname or IP address&gt;</code></pre>
</div>
<div id="show-domain-name-and-host-name" class="section level2">
<h2>Show domain name and host name</h2>
<p>Show the domain name</p>
<pre><code>domainname</code></pre>
<p>Show the host name</p>
<pre><code>hostname</code></pre>
</div>
</div>
<div id="open-files-and-folders-in-the-gui" class="section level1">
<h1>Open files and folders in the GUI</h1>
<p>If bash is running inside a Graphical desktop environment, you can
open the current folder with</p>
<pre><code>xdg-open .</code></pre>
<p>And open any file with the preferred application with for example</p>
<pre><code>xdg-open filename.pdf
xdg-open filename.mp4</code></pre>
<p>I created an alias in <code>.bash_aliases</code></p>
<pre><code>alias open=&quot;xdg-open&quot;</code></pre>
<p>There is already an <code>open</code> command on some systems. But
creating an alias for it should be safe according to an answer to this
<a
href="https://stackoverflow.com/questions/12329876/is-it-safe-to-alias-open-with-xdg-open">SO
question</a> because “once you alias it, it’s valid only for your
user”.</p>
<p>The alias makes it possible to open files with the simple command</p>
<pre><code>open .</code></pre>
<div id="open-many-files" class="section level2">
<h2>Open many files</h2>
<p><a
href="https://askubuntu.com/questions/356650/how-to-open-multiple-files-with-the-default-program-from-terminal">Open
many files with xdg-open</a></p>
<pre><code>find -iname &#39;*.pdf&#39; -print0 | xargs -0 -n 1 xdg-open</code></pre>
<p>These simpler version of the same command have issues with files that
have spaces or quotes in their names</p>
<pre><code>ls *.pdf| xargs -n 1 open
ls *.pdf |xargs -L 1 open</code></pre>
</div>
</div>
<div id="move-copy-rename-compress-files" class="section level1">
<h1>Move, copy, rename, compress files</h1>
<p>Copy a file</p>
<pre><code>cp file1 file2</code></pre>
<p>To copy a file from /tmp/file.md to /tmp/file2.md</p>
<pre><code>cp /tmp/file.md /tmp/file2.md</code></pre>
<div id="rsync" class="section level2">
<h2>Rsync</h2>
<p>Copy a folder and all it’s content to a remote server:</p>
<pre><code>rsync -zav ~/repos/forobs/tradetools/ edartrade:repos/tradetools/</code></pre>
<p>Note the slash at the end of the first repo is very important, other
wise it crease a sub repos with the same name inside
<code>edartrade</code> on the remote machine. More explanations on the
section slashes.</p>
<p>Rsync man page:</p>
<blockquote>
<p>Rsync is a fast and extraordinarily versatile file copying tool. It
can copy locally, to/from another host over any remote shell, or to/from
a remote rsync daemon. […] It is famous for its delta-transfer
algorithm, which reduces the amount of data sent over the network by
sending only the differences between the source files and the existing
files in the destination. Rsync is widely used for backups and mirroring
and as an improved copy command for everyday use.</p>
</blockquote>
<p>The most important option is -a:</p>
<pre><code>-a, --archive archive mode; equals -rlptgoD (no -H,-A,-X)</code></pre>
<p>The option <code>-a</code> does all of the following:</p>
<pre><code>-r, --recursive             recurse into directories
-l, --links                 copy symlinks as symlinks
-p, --perms                 preserve permissions
-t, --times                 preserve modification times
-g, --group                 preserve group
-o, --owner                 preserve owner (super-user only)
    --devices               preserve device files (super-user only)
    --specials              preserve special files
-D                          same as --devices --specials</code></pre>
<p>Other options I have used:</p>
<pre><code>-v, --verbose increase verbosity, use -vv for more verbose.
-z, --compress compress file data during the transfer</code></pre>
<p>To sync <a href="https://stackoverflow.com/a/11111793/2641825">only
some file extensions</a></p>
<blockquote>
<p>“So if we only want <code>*.sh</code> files we have to exclude all
files <code>--exclude="*"</code>, include all directories
<code>--include="*/"</code> and include all <code>*.sh</code> files
<code>--include="*.sh"</code>.”</p>
</blockquote>
<p>Sync only <code>.mdb</code> files that are the output of a model</p>
<pre><code>rsync -zav --include=&quot;*/&quot; --include=&quot;*.mdb&quot; --exclude=&quot;*&quot;  /home/paul/rp/cbmcfs3_data/scenarios/static_demand/ edartrade:static_demand/</code></pre>
<div id="slash-or-no-slash" class="section level3">
<h3>Slash or no slash</h3>
<p><a href="https://stackoverflow.com/a/31278462/2641825">SO slashes and
the rsync command</a> quoting the rsync man page:</p>
<blockquote>
<p>“A trailing slash on the source changes this behavior to avoid
creating an additional directory level at the destination. You can think
of a trailing / on a source as meaning”copy the contents of this
directory” as opposed to “copy the directory by name”, but in both cases
the attributes of the containing directory are transferred to the
containing directory on the destination. In other words, each of the
follow‐ ing commands copies the files in the same way, including their
setting of the attributes of /dest/foo: ”</p>
</blockquote>
<pre><code>rsync -av /src/foo /dest
rsync -av /src/foo/ /dest/foo</code></pre>
</div>
</div>
<div id="flatten-a-file-hierarchy" class="section level2">
<h2>Flatten a file hierarchy</h2>
<p>Copy all files in the folder hierarchy to a flat folder at the root.
<a
href="https://askubuntu.com/questions/633945/how-can-i-merge-multiple-directories-into-one">solution
from askubuntu</a></p>
<pre><code>find . -type f -print0 | xargs -0 -I file mv --backup=numbered file .</code></pre>
<p>I also follow with <a
href="https://unix.stackexchange.com/a/371393/85530">another
command</a></p>
<pre><code>rename &#39;s/((?:\..+)?)\.~(\d+)~$/_$2$1/&#39; *.~*~</code></pre>
<p>to keep the numbering of duplicated files before the extension.</p>
</div>
<div id="compress-and-decompress-files" class="section level2">
<h2>Compress and decompress files</h2>
<p>Compress a file using gzip or 7z compression</p>
<pre><code>gzip &lt;filename&gt;
7zr a -si&lt;filename&gt; &lt;filename&gt;.7z </code></pre>
<p>Decompress a single file from several archive formats:</p>
<pre><code>bzip2 -d &lt;filename.bz2&gt;
gunzip &lt;filename.gz&gt;</code></pre>
<p><a href="https://askubuntu.com/a/499809/315347">Askubuntu to extract
a .tgz file with tar you need to use,</a></p>
<pre><code>tar -xvzf /path/to/file.tgz
tar -xvzf /path/to/file.tgz -C /path/where/to/extract/ 
# Extract in a folder that has the archive name
tar --extract -f /path/to/file.tgz --one-top-leve
7zr e &lt;filename.7z&gt; # extract all files in the same directory 
7zr x &lt;filename.7z&gt; # keep directory structure (see also multiple files below)</code></pre>
<p>Convert a 7z file to gz using a pipe similar to <a
href="https://superuser.com/a/357980/419414">this answer</a>.</p>
<pre><code>7zr e -so &lt;filename.7z&gt; | gzip -c &gt; &lt;filename.gz&gt;</code></pre>
</div>
<div id="compress-multiple-files" class="section level2">
<h2>Compress multiple files</h2>
<p>How do I compress a whole directory?</p>
<pre><code>tar -zcvf archive-name.tar.gz directory-name </code></pre>
<p>Where</p>
<pre><code>-z: Compress archive using gzip program
-c: Create archive
-v: Verbose i.e display progress while creating archive
-f: Archive File name</code></pre>
<p>Decompress an archive containing multiple files Keep full path of
files within the archive To extract content from the archive in the
current directory</p>
<pre><code>tar -zxvf archive-name.tar.gz 
7zr x &lt;filename.7z&gt;  </code></pre>
<p>List content of an archive</p>
<pre><code>7zr l &lt;filename.7z&gt;</code></pre>
<div id="zip-archive" class="section level3">
<h3>Zip archive</h3>
<p>Create the zip archive of a directory</p>
<pre><code>zip dir.zip -r dir</code></pre>
</div>
</div>
<div id="recursive-copy-of-some-files" class="section level2">
<h2>Recursive copy of some files</h2>
<p><a
href="https://unix.stackexchange.com/questions/83593/copy-specific-file-type-keeping-the-folder-structure">Recursive
copy some files while keeping the directory structure</a></p>
<pre><code>find . -name &#39;*.csv&#39; -exec cp --parents \{\} /target \;</code></pre>
<p>Move files from various sub folders to the same folder see the
section on a flatten a file hierarchy for a description.</p>
<pre><code>cd ~/Pictures/scan</code></pre>
</div>
<div id="rename-files" class="section level2">
<h2>Rename files</h2>
<p>For example to rename all upper-case .JPG extension into lower-case
.jpg extension.</p>
<pre><code>rename &#39;s/\.JPG$/\.jpg/&#39; *.JPG</code></pre>
</div>
</div>
<div id="program-with-bash" class="section level1">
<h1>Program with bash</h1>
<div id="makefile" class="section level2">
<h2>Makefile</h2>
<p>I use GNU make and the following simple make file to generate all
pages in this website:</p>
<pre><code>render:
     Rscript -e &quot;rmarkdown::render_site()&quot;</code></pre>
<div id="build-an-r-package" class="section level3">
<h3>Build an R package</h3>
<p>The makefile below builds the FAOSTAT R package. I modified it from
knitr’s makefile.</p>
<pre><code># Usage:
# build the package&#39;s tarball, check and remove the ../FAOSTAT.Rcheck folder:
# make
# build the package&#39;s tarball and check (keep the ../FAOSTAT.Rcheck folder):
# make check
# generate the documentation:
# make docs
#
# This makefile was copied and apdapted from  yihui / knitr 
# https://github.com/yihui/knitr/blob/master/Makefile

# prepare the package for release
PKGNAME := $(shell sed -n &quot;s/Package: *\([^ ]*\)/\1/p&quot; DESCRIPTION)
PKGVERS := $(shell sed -n &quot;s/Version: *\([^ ]*\)/\1/p&quot; DESCRIPTION)
PKGSRC  := $(shell basename `pwd`)

all: docs check clean

deps:
    tlmgr install pgf preview xcolor;\
    Rscript -e &#39;if (!require(&quot;Rd2roxygen&quot;)) install.packages(&quot;Rd2roxygen&quot;, repos=&quot;http://cran.rstudio.com&quot;)&#39;

docs:
    R -q -e &quot;devtools::document(roclets = c(&#39;rd&#39;, &#39;collate&#39;, &#39;namespace&#39;, &#39;vignette&#39;))&quot;

build:
    cd ..;\
    R CMD build $(PKGSRC)

install: build
    cd ..;\
    R CMD INSTALL $(PKGNAME)_$(PKGVERS).tar.gz

check: build
    cd ..;\
    R CMD check $(PKGNAME)_$(PKGVERS).tar.gz --as-cran

clean:
    cd ..;\
    $(RM) -r $(PKGNAME).Rcheck/
    </code></pre>
</div>
<div id="compile-a-latex-article" class="section level3">
<h3>Compile a latex article</h3>
<p>This make file compiles a latex article to pdf and generate a zip
file containing all documents necessary to generate the article and
another zip file containing the figures.</p>
<pre><code># Usage:
# make        # Generate the pdf and zip files for the submission. 
# make render # Render the pdf, keep all automatically generated files for Latex diagnostics.
# make clean  # Keep a copy of the pdf one level above and remove automatically generated files.
# make zip    # Generate the zip archive of the article and figures for the submission process.
#
all: render clean zip

render:
     latexmk -pdf -bibtex -use-make template.tex

clean:
     cp template.pdf ../manuscript.pdf || echo &quot;Template.pdf not there.&quot;
     git clean -xf

zip: # Remove the zip archive otherwise deleted files will remain in the archive and it will be simply updated
     rm ../manuscript.zip ../figures.zip || echo &quot;No existing zip archive to delete.&quot;
     zip ../manuscript.zip -r *
     zip ../figures.zip -r figures/*
     echo &quot;Verify that the pdf and zip archives have been updated by checking their update time.&quot;
     ls -lh ../*.zip
     ls -lh ../*.pdf</code></pre>
</div>
<div id="convert-documents-with-pandoc" class="section level3">
<h3>Convert documents with pandoc</h3>
<p>Generic <a
href="https://gist.github.com/famuvie/dc6ff6c0a0155e0e2d7f281f1a6d4d69">makefile
for pandoc</a></p>
</div>
</div>
<div id="pipe" class="section level2">
<h2>Pipe</h2>
<p>Pipe the output of ls to grep</p>
<pre><code>ls | grep &quot;.md$&quot;</code></pre>
<p>When the command doesn’t read from stdin by default, use xargs</p>
<pre><code>echo README.md | xargs ls -lah
ls -a | xargs realpath</code></pre>
<p>Based on an <a
href="https://superuser.com/a/890349/419414">explanation of xargs and
pipes</a>. When piped to cat, this command simply displays the text
“README.md”</p>
<pre><code>echo README.md | cat</code></pre>
<p>Using <code>xargs</code>, the output of echo is interpreted as a file
name</p>
<pre><code>echo README.md | xargs cat</code></pre>
</div>
<div id="try-catch" class="section level2">
<h2>Try catch</h2>
<p><a
href="https://stackoverflow.com/questions/22009364/is-there-a-try-catch-command-in-bash">Is
there a try catch command in bash</a></p>
<blockquote>
<p>There is no try/catch in bash; however, one can achieve similar
behavior using &amp;&amp; or ||.</p>
</blockquote>
<blockquote>
<p>Using ||: if command1 fails then command2 runs as follows</p>
</blockquote>
<pre><code>command1 || command2</code></pre>
<blockquote>
<p>Similarly, using &amp;&amp;, command2 will run if command1 is
successful</p>
</blockquote>
</div>
<div id="variables" class="section level2">
<h2>Variables</h2>
<p><a
href="https://www.shellscript.sh/variables1.html">Variables</a></p>
<pre><code>message = &quot;Hello World&quot;
echo $message</code></pre>
</div>
<div id="wild-cards" class="section level2">
<h2>Wild cards</h2>
<p>Search for a pattern in python and R files:</p>
<pre><code>grep -n &lt;pattern&gt; *{py,R}</code></pre>
</div>
</div>
<div id="read" class="section level1">
<h1>Read</h1>
<div id="hexadecimal-dump" class="section level2">
<h2>Hexadecimal dump</h2>
<p>Show the last 3 lines of a file as a hexadecimal dump</p>
<pre><code>xxd -s -0x30 Trade_DetailedTradeMatrix_E_All_Data_\(Normalized\).csv</code></pre>
</div>
<div id="play-midi-files" class="section level2">
<h2>Play Midi files</h2>
<p>Install a software synthesizer to play midi files. <a
href="https://wiki.videolan.org/Midi/">VideoLan Wiki</a></p>
<blockquote>
<p>If the FluidSynth codec is not shown in VLC’s preferences, you have
to install it as well as sound fonts. E.g. on Ubuntu 14.04 and
derivatives it is in the vlc-plugin-fluidsynth package, while the
fluid-soundfont-gs and fluid-soundfont-gm packages install some
sound</p>
</blockquote>
<p>Installation instruction:</p>
<pre><code>sudo apt install vlc-plugin-fluidsynth fluid-soundfont-gs fluid-soundfont-gm</code></pre>
</div>
<div id="play-music-with-cmus" class="section level2">
<h2>Play music with cmus</h2>
<p><a
href="https://github.com/cmus/cmus/blob/master/Doc/cmus-tutorial.txt">Cmus
tutorial</a>:</p>
<pre><code>man cmus-tutorial</code></pre>
<p>Cmus has several view modes. When starting cmus for the first time
press 5 to go to the file-browser panel, choose a folder and press “a”
to add it to the cmus library. Then press “2” to go to the simple
library view or press “1” to go to the artist/album view.</p>
<p>Here is the list of view modes:</p>
<pre><code>1 view tree
2 view sorted
3 view playlist
4 view queue
5 view browser
6 view filters
7 view settings</code></pre>
<table>
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Common Context</th>
<th>Remote Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td>player-next</td>
<td></td>
</tr>
<tr class="even">
<td>C</td>
<td></td>
<td>Continue at end of track</td>
</tr>
<tr class="odd">
<td>c</td>
<td>player-pause</td>
<td></td>
</tr>
<tr class="even">
<td>q</td>
<td>quit -i</td>
<td></td>
</tr>
<tr class="odd">
<td>s</td>
<td>shuffle</td>
<td></td>
</tr>
<tr class="even">
<td>t</td>
<td></td>
<td>toggle show_remaining_time</td>
</tr>
<tr class="odd">
<td>v</td>
<td>player-stop</td>
<td></td>
</tr>
<tr class="even">
<td>x</td>
<td>player-play</td>
<td></td>
</tr>
<tr class="odd">
<td>z</td>
<td>player-prev</td>
<td></td>
</tr>
<tr class="even">
<td>e</td>
<td></td>
<td><strong>append tracks to the play queue</strong></td>
</tr>
<tr class="odd">
<td>E</td>
<td></td>
<td>prepend tracks to the play queue</td>
</tr>
</tbody>
</table>
<p>Commands can be sent through a command line with cmus-remote, for
example to pause a running instance of cmus (and restart it):</p>
<pre><code>cmus-remote -C player-pause</code></pre>
<p>I use this in the pomodoro gnome app to pause music at breaks.</p>
<p>Volume control</p>
<table>
<thead>
<tr class="header">
<th>Common Context</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>=</td>
<td>:vol +10%</td>
</tr>
<tr class="even">
<td>+</td>
<td>:vol +10%</td>
</tr>
<tr class="odd">
<td>-</td>
<td>:vol -10%</td>
</tr>
<tr class="even">
<td>[</td>
<td>:vol +1% +0%</td>
</tr>
<tr class="odd">
<td>]</td>
<td>:vol +0% +1%</td>
</tr>
<tr class="even">
<td>{</td>
<td>:vol -1% -0%</td>
</tr>
<tr class="odd">
<td>}</td>
<td>:vol -0% -1%</td>
</tr>
</tbody>
</table>
<p>Jump to currently playing song <code>i</code>. Follow currently
playing song <code>f</code> see <a
href="https://github.com/cmus/cmus/issues/206">issue 206</a></p>
<p>There is a feedback of all the currently active options at the bottom
right of the cums screen.</p>
<div id="playlist" class="section level3">
<h3>Playlist</h3>
<p>Create a playlist file, in bash</p>
<pre><code>find -name &#39;*.ogg&#39;&gt; playlist.m3u</code></pre>
<p>Open a playlist in the playlist view (4), in the cmus command
pane</p>
<pre><code>:load playlist.m3u</code></pre>
<p>Add a song from the library view (2) to the playlist view (4)</p>
<pre><code>y</code></pre>
<p>Delete a song from the playlist view (4)</p>
<pre><code>:suppr</code></pre>
<p>Save the modified playlist file</p>
<pre><code>:save</code></pre>
</div>
<div id="cmus-and-other-audio-programs" class="section level3">
<h3>Cmus and other audio programs</h3>
<p>Some programs such as Skype or MS teams (based on Skype and chromium)
turn off the volume of cmus when entering into a phone call. They
sometimes forget to put it back on. You can turn the volume back on into
Gnome’s sound configuration menu, under the applications tab.</p>
</div>
</div>
<div id="read-csv-in-bash" class="section level2">
<h2>Read CSV in bash</h2>
<p><a
href="https://www.cyberciti.biz/faq/unix-linux-bash-read-comma-separated-cvsfile/">Read
CSV in bash</a></p>
</div>
<div id="read-text-files" class="section level2">
<h2>Read text files</h2>
<p>With less or vim (see the vim page).</p>
<div id="head-and-tail" class="section level3">
<h3>Head and tail</h3>
<p>Display the first 2 lines of a text file</p>
<pre><code>head -2 file.txt</code></pre>
<p>Display the last 2 lines of a text file</p>
<pre><code>tail -2 file.txt</code></pre>
</div>
</div>
</div>
<div id="record-a-terminal-session" class="section level1">
<h1>Record a terminal session</h1>
<p>Record a terminal session with tools such as:</p>
<ul>
<li><p>asciinema</p></li>
<li><p>ttygif</p></li>
</ul>
</div>
<div id="refactor" class="section level1">
<h1>Refactor</h1>
<p><a href="https://stackoverflow.com/a/21685766/2641825">A one liner to
replace strings with perl in a git repository</a>. The examples below
replace all occurrences of the first string with the second string, for
all files under git version control.</p>
<pre><code>git grep -lz &#39;first_string&#39;| xargs -0 perl -i&#39;&#39; -pE &quot;s/first_string/second_string/g&quot;
git grep -lz &#39;readcsvfromgauss&#39;| xargs -0 perl -i&#39;&#39; -pE &quot;s/readcsvfromgauss/readcsvfromgauss0/g&quot;
git grep -lz &#39;RMySQL::&#39;| xargs -0 perl -i&#39;&#39; -pE &quot;s/RMySQL::/RMariaDB::/g&quot;</code></pre>
<p>Alias to refactor, use single quotes for the patterns:</p>
<pre><code>refactor() {
    echo &quot;Replacing $1 by $2 in all files in this git repository.&quot;
    git grep -lz &quot;$1&quot;| xargs -0 perl -i&#39;&#39; -pE &quot;s/$1/$2/g&quot;
}</code></pre>
<p>When there are slashes in the patterns, use another separator</p>
<pre><code>refactor() {
    echo &quot;Replacing $1 by $2 in all files in this git repository.&quot;
    git grep -lz &quot;$1&quot;| xargs -0 perl -i&#39;&#39; -pE &quot;s|$1|$2|g&quot;
}</code></pre>
<p>Usage, for example replace ‘word’ with ‘sword’:</p>
<pre><code>refactor word sword
git diff</code></pre>
</div>
<div id="security-and-authentication" class="section level1">
<h1>Security and authentication</h1>
<div id="generate-passwords" class="section level2">
<h2>Generate passwords</h2>
<p><a href="https://packages.debian.org/buster/apg">apg</a> is an
automated password generator. According to the Debian maintainers, it is
not updated upstream and it might be replaced by another tool as soon as
“a maintained software with a comparable feature set becomes available”.
Usage:</p>
<pre><code>apg</code></pre>
<p>A post on Unix &amp; Linux Stack Exchange recommends using
<code>/dev/urandom</code> as such</p>
<pre><code>cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | head -c 20</code></pre>
<p>To create passwords that are hard for attackers to guess but easy to
remember, have a look at this <a href="https://xkcd.com/936/">xkcd comic
strip</a>. It explains how password entropy rises faster with the number
of characters than with the character set weirdness.</p>
<p>When possible, it’s better to authenticate with private and public
key cryptography.</p>
</div>
<div id="ssh-secure-shell" class="section level2">
<h2>SSH Secure Shell</h2>
<div id="generate-ssh-keys-and-add-them-to-the-agent"
class="section level3">
<h3>Generate SSH keys and add them to the agent</h3>
<p>Mon Sep 28 09:36:26 CEST 2020 Generate a new key</p>
<pre><code>cd ~/.ssh
ssh-keygen &lt;id_rsa_keyname&gt;</code></pre>
<p>Temporarily add a key to ssh</p>
<pre><code>ssh-add ~/.ssh/&lt;id_rsa_keyname&gt;</code></pre>
<p>List keys</p>
<pre><code>ssh-add -l</code></pre>
<p>After a restart of the ssh agent</p>
<pre><code>killall ssh-agent
eval `ssh-agent`</code></pre>
<p>This key will not be available anymore to <a
href="https://stackoverflow.com/a/4246809/2641825">permanently add a key
to the ssh config file</a> (SO) Edit your <code>~/.ssh/config</code>
file:</p>
<pre><code>IdentityFile ~/.ssh/&lt;id_rsa_keyname&gt;</code></pre>
<p>If the key was generated with a password,and you don’t exactly
remember the password, you can <a
href="https://stackoverflow.com/a/23666831/2641825">test a few password
you might remember with</a>:</p>
<pre><code>ssh-keygen -y -f &lt;private_key_file_name&gt;</code></pre>
<p>Note if you copy keys from one machine to another, you might
encounter this error: <a
href="https://stackoverflow.com/questions/9270734/ssh-permissions-are-too-open-error">ssh
“permissions are too open” error</a></p>
<p>Change the permission so only the current user has access to the
file:</p>
<pre><code>chmod 600 id_rsa</code></pre>
</div>
<div id="load-ssh-keys-into-the-remote-server" class="section level3">
<h3>Load SSH keys into the remote server</h3>
<p>Based on <a
href="https://www.cyberciti.biz/faq/how-to-set-up-ssh-keys-on-linux-unix/">Install
the public key in remote server</a> Once you have an ssh key on your
local machine, you need to load it into the remote server’s authorized
keys as such:</p>
<pre><code>ssh-copy-id -i $HOME/.ssh/id_rsa.pub user@server</code></pre>
<p>OR just copy the public key in remote server as authorized_keys in
~/.ssh/ directory:</p>
<pre><code>scp $HOME/.ssh/id_rsa.pub user@server:~/.ssh/authorized_keys</code></pre>
<p>The remainder of the <a
href="https://www.cyberciti.biz/faq/how-to-set-up-ssh-keys-on-linux-unix/">cybercity.biz
document</a> explains how to disable the password based login on a
server.</p>
</div>
<div id="check-a-keys-fingerprint" class="section level3">
<h3>Check a key’s fingerprint</h3>
<p>On github, ssh key fingerprints are displayed in md5format. To
display the fingerprint in md5format, enter:</p>
<pre><code>ssh-keygen -l -E md5 -f ~/.ssh/id_rsa.pub</code></pre>
<p><a
href="https://superuser.com/questions/421997/what-is-a-ssh-key-fingerprint-and-how-is-it-generated">How
to generate an SSH key fingerprint</a></p>
</div>
<div id="forward-agent-and-alternatives" class="section level3">
<h3>Forward agent and alternatives</h3>
<ul>
<li><a
href="https://heipei.io/2015/02/26/SSH-Agent-Forwarding-considered-harmful/">SSH
Agent Forwarding considered harmful</a>
<ul>
<li><a href="https://news.ycombinator.com/item?id=9425805">Related
discussion on hacker news</a></li>
</ul></li>
<li><a
href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/ssh-forward-agent-exploitation">SSH
forward agent exploitation</a></li>
</ul>
<p>Alternatives: - use ProxyCommand - Use a github or gitlab deploy
token to clone a repository on the server</p>
</div>
<div id="log-in-to-a-secure-shell-and-secure-copy"
class="section level3">
<h3>Log in to a secure shell and secure copy</h3>
<p>log into a remote machine</p>
<pre><code>ssh user@remote_machine</code></pre>
<p>Copy a local file to a file on the remote machine</p>
<pre><code>scp local_file_name user@remote_machine:path_to_file/file_name</code></pre>
<p>Copy a file from the remote machine to a local file</p>
<pre><code>scp user@remote_machine:path_to_file/file_name  local_file_name</code></pre>
<p>Copy a full directory (dmouraty) from the remote machine:</p>
<pre><code> scp -rp user@dest:/path destdirectory</code></pre>
</div>
<div id="ssh-config" class="section level3">
<h3>SSH config</h3>
<p>To speed up login aliases can be set up in ~/.ssh/config</p>
<pre><code>Host host_name
  user paul
  hostname ip_address </code></pre>
</div>
<div id="ssh-tunnel" class="section level3">
<h3>SSH tunnel</h3>
<p>Tunnel to a jupyter notebook on a server</p>
<pre><code>alias tunnelnotebook=&quot;ssh -L 8888:localhost:8888 servername -N&quot;</code></pre>
</div>
<div id="passwordless-access-for-root-user" class="section level3">
<h3>Passwordless access for root user</h3>
<p><a
href="https://askubuntu.com/questions/115151/how-to-set-up-passwordless-ssh-access-for-root-user">How
to set up passwordless SSH access for root user</a></p>
</div>
</div>
<div id="gpg-signing-keys" class="section level2">
<h2>GPG signing keys</h2>
<p>See also the <a href="communication.html">communication page</a> on
security issues related to PGP such as the Efail vulnerability.
According to several authors PGP’s cryptography is really old and it is
probably not the best encryption tool nowadays. Part of the issue is
also related to the fact that email is a fundamentally unsecure
communication tool.</p>
<p>Generate a PGP key</p>
<pre><code>gpg --gen-key</code></pre>
<div id="public-key-servers" class="section level3">
<h3>Public key servers</h3>
<p>To submit your key to a server, export the key</p>
<pre><code>gpg -a --export name@emailserver.com &gt; public_key_sender.asc </code></pre>
<p>My keys were visible on pgp.mit.edu <a
href="https://pgp.mit.edu/pks/lookup?search=rougieux&amp;op=index">search=rougieux</a>.
2019 Update following a look at a super user <a
href="https://superuser.com/a/1498334/419414">answer on public key
servers</a>, I uploaded my public key to</p>
<pre><code>https://keys.openpgp.org/upload</code></pre>
<p>My keys are searchable at</p>
<pre><code>https://keys.openpgp.org/</code></pre>
<p>Import a key from a public key server</p>
<pre><code>curl -s &#39;https://keys.openpgp.org/vks/v1/by-fingerprint/6813A4C1B326F4A6A65336D9B6838AB252DD02F7&#39; | gpg --import</code></pre>
<p><a href="https://keys.openpgp.org/about/usage#gnupg">GNUPG
instructions</a> from openpgp.org</p>
</div>
<div id="encrypt-and-decrypt" class="section level3">
<h3>Encrypt and decrypt</h3>
<p>Encrypt a document for a particular recipient</p>
<pre><code>gpg --encrypt --recipient user@email file.ext
gpg -er user@email file.ext</code></pre>
<p>Encrypt and sign a document</p>
<pre><code>gpg --encrypt --sign --recipient user@email file.ext
gpg -esr user@email file.ext</code></pre>
<p>Decrypt a document</p>
<pre><code>gpg --output file.ext --decrypt file.ext.gpg</code></pre>
</div>
<div id="sign-files" class="section level3">
<h3>Sign files</h3>
<p>Sign a file</p>
<pre><code>gpg --sign filename.ext</code></pre>
<p><a
href="https://unix.stackexchange.com/questions/481939/how-to-export-a-gpg-private-key-and-public-key-to-a-file">Export
GPG private and public key to a file</a></p>
<p>Verify the signature of a file</p>
<pre><code>gpg --verify filename.ext.gpg</code></pre>
</div>
<div id="trust-other-public-keys" class="section level3">
<h3>Trust other public keys</h3>
<div id="sign-public-keys" class="section level4">
<h4>Sign public keys</h4>
<p><a href="https://www.gnupg.org/gph/en/manual/x56.html"></a></p>
<blockquote>
<p>“Once a key is imported it should be validated.”</p>
</blockquote>
<pre><code>alice% gpg --edit-key blake@cyb.org

pub  1024D/9E98BC16  created: 1999-06-04 expires: never      trust: -/q
sub  1024g/5C8CBD41  created: 1999-06-04 expires: never
(1)  Blake (Executioner) &lt;blake@cyb.org&gt;

Command&gt; fpr
pub  1024D/9E98BC16 1999-06-04 Blake (Executioner) &lt;blake@cyb.org&gt;
             Fingerprint: 268F 448F CCD7 AF34 183E  52D8 9BDE 1A08 9E98 BC16</code></pre>
<blockquote>
<p>“A key’s fingerprint is verified with the key’s owner. This may be
done in person or over the phone or through any other means as long as
you can guarantee that you are communicating with the key’s true owner.
If the fingerprint you get is the same as the fingerprint the key’s
owner gets, then you can be sure that you have a correct copy of the
key.</p>
</blockquote>
<blockquote>
<p>After checking the fingerprint, you may sign the key to validate it.
Since key verification is a weak point in public-key cryptography, you
should be extremely careful and always check a key’s fingerprint with
the owner before signing the key.”</p>
</blockquote>
<pre><code>Command&gt; sign

pub  1024D/9E98BC16  created: 1999-06-04 expires: never      trust: -/q
             Fingerprint: 268F 448F CCD7 AF34 183E  52D8 9BDE 1A08 9E98 BC16

     Blake (Executioner) &lt;blake@cyb.org&gt;

Are you really sure that you want to sign this key
with your key: &quot;Alice (Judge) &lt;alice@cyb.org&gt;&quot;

Really sign?</code></pre>
<blockquote>
<p>“Once signed you can check the key to list the signatures on it and
see the signature that you have added. Every user ID on the key will
have one or more self-signatures as well as a signature for each user
that has validated the key.”</p>
</blockquote>
<pre><code>Command&gt; check
uid  Blake (Executioner) &lt;blake@cyb.org&gt;
sig!       9E98BC16 1999-06-04   [self-signature]
sig!       BB7576AC 1999-06-04   Alice (Judge) &lt;alice@cyb.org&gt;</code></pre>
</div>
<div id="edit-the-trust-level" class="section level4">
<h4>Edit the trust level</h4>
<p>Edit the trust level of a key</p>
<p><a href="https://www.gnupg.org/gph/en/manual/x334.html">Validating
other keys on your public keyring</a></p>
<pre><code>alice% gpg --edit-key blake

pub  1024D/8B927C8A  created: 1999-07-02 expires: never      trust: q/f
sub  1024g/C19EA233  created: 1999-07-02 expires: never     
(1)  Blake (Executioner) &lt;blake@cyb.org&gt;

Command&gt; trust
pub  1024D/8B927C8A  created: 1999-07-02 expires: never      trust: q/f
sub  1024g/C19EA233  created: 1999-07-02 expires: never     
(1)  Blake (Executioner) &lt;blake@cyb.org&gt;

Please decide how far you trust this user to correctly
verify other users&#39; keys (by looking at passports,
checking fingerprints from different sources...)?

 1 = Don&#39;t know
 2 = I do NOT trust
 3 = I trust marginally
 4 = I trust fully
 s = please show me more information
 m = back to the main menu

Your decision? 3
                
pub  1024D/8B927C8A  created: 1999-07-02 expires: never      trust: m/f
sub  1024g/C19EA233  created: 1999-07-02 expires: never     
(1)  Blake (Executioner) &lt;blake@cyb.org&gt;

Command&gt; quit</code></pre>
</div>
</div>
<div id="manage-keys" class="section level3">
<h3>Manage keys</h3>
<p>List keys</p>
<pre><code>gpg --list-keys
gpg --list-public-keys
gpg --list-secret-keys</code></pre>
<p>List files in the keyring</p>
<pre><code>tree ~/.gnupg/</code></pre>
<p>Delete a key from the public keyring</p>
<pre><code>gpg --delete-keys name</code></pre>
<p>Delete a key from the private keyring</p>
<pre><code>gpg --delete-secret-keys name</code></pre>
</div>
<div id="sks-pool" class="section level3">
<h3>SKS pool</h3>
<p>keys.openpgp.org <a
href="https://keys.openpgp.org/about/faq">FAQ</a></p>
<blockquote>
<p>“Is this server part of the”SKS” pool? ”</p>
</blockquote>
<blockquote>
<p>No. The federation model of the SKS pool has various problems in
terms of reliability, abuse-resistance, privacy, and usability. We might
do something similar to it, but keys.openpgp.org will never be part of
the SKS pool ITSELF. ”</p>
</blockquote>
</div>
</div>
</div>
<div id="system" class="section level1">
<h1>System</h1>
<div id="disk-usage-and-memory" class="section level2">
<h2>Disk usage and memory</h2>
<p>Disk usage</p>
<pre><code>du -hd1  # sub-folder size at depth=1 
du -hs * # sub-folder size summary</code></pre>
<p>Display available space on drives</p>
<pre><code>df -h</code></pre>
<p>Display available RAM memory</p>
<pre><code>cat /proc/meminfo</code></pre>
</div>
<div id="environment-variables-1" class="section level2">
<h2>Environment variables</h2>
<p>Show environment variables</p>
<pre><code>printenv 
printenv LC_TIME</code></pre>
</div>
<div id="jobs-and-processes" class="section level2">
<h2>Jobs and processes</h2>
<div id="monitor-processes" class="section level3">
<h3>Monitor processes</h3>
<p>Display Linux processes</p>
<pre><code>top</code></pre>
<p>Interactive process viewer</p>
<pre><code>htop</code></pre>
<p>Run a command every 2 seconds, for example to list a folder as new
files are being written to it:</p>
<pre><code>watch ls</code></pre>
<p>Follow the end of a log file, as it is written</p>
<pre><code>tail filename.log</code></pre>
<p>Find out which program is listening to which port</p>
<pre><code>sudo netstat -pna | grep &lt;port_number&gt;</code></pre>
</div>
<div id="start-stop-move-to-background" class="section level3">
<h3>Start, stop, move to background</h3>
<p>List</p>
<pre><code>jobs</code></pre>
<p>Bring a job to the foreground</p>
<pre><code>fg job_number</code></pre>
<p>Run a job in the background. A command followed by an &amp; will run
in the background.</p>
<p>Stop a job</p>
<pre><code>CTRL ^ Z</code></pre>
<p>Move a stopped job to the background</p>
<pre><code>bg</code></pre>
<p><a
href="https://www.digitalocean.com/community/tutorials/how-to-use-bash-s-job-control-to-manage-foreground-and-background-processes">How
to manage foreground and background processes</a> “By default, the bg
command operates on the most recently stopped process. If you’ve stopped
multiple “</p>
<p>Quit a job</p>
<pre><code> CTRL ^ C</code></pre>
<p>Kill a malfunctioning program:</p>
<pre><code>kill process_id
kill -9 process_it # -9 forces the kill</code></pre>
<p>Find a program id with:</p>
<pre><code>ps aux</code></pre>
<p>Kill a graphical program, by clicking on it:</p>
<pre><code> xkill</code></pre>
</div>
</div>
<div id="keyboard" class="section level2">
<h2>Keyboard</h2>
<p>bash french blogger recommended a simple shell command to change
keyboard layout :</p>
<pre><code>sudo loadkeys fr</code></pre>
<p>fr-keyboard on Debian wiki for a more permanent system configuration
and use in GUI apps. Switching between keyboads can then be done
with:</p>
<pre><code>setxkbmap de
setxkbmap fr</code></pre>
<p>Information about the system Debian-Admin Finding out basic
information about your Hardware:</p>
<pre><code>cat /proc/meminfo
cat /proc/cpuinfo</code></pre>
<p>Find your Debian version</p>
<pre><code>cat /etc/debian_version
lsb_release -a</code></pre>
<p>Shortcuts Keyboard shortcuts for bash for example :</p>
<ul>
<li>Ctrl+A to go to the beginning of a line</li>
<li>Ctrl+E to go to the end of a line</li>
</ul>
<p>Documentation</p>
<pre><code>Creating and running bash scripts
Unofficial Ubuntu starter guide.</code></pre>
</div>
<div id="locale" class="section level2">
<h2>Locale</h2>
<p><a href="https://wiki.debian.org/Locale">Debian wiki page on Locale
settings</a></p>
<p>Display locale settings</p>
<pre><code>locale</code></pre>
<p>To install new locales, run :</p>
<pre><code>sudo dpkg-reconfigure locales</code></pre>
<p>SSH forwards locales to the server. The server will try to use the
given locale, but it might not have them installed. <a
href="https://askubuntu.com/questions/144235/locale-variables-have-no-effect-in-remote-shell-perl-warning-setting-locale-f/144448#144448">Locale
variables have no effect in remote shell</a></p>
<p><a
href="https://askubuntu.com/questions/76013/how-do-i-add-locale-to-ubuntu-server">How
do I add a locale to a Ubuntu Server?</a> Check which locales are
supported:</p>
<pre><code>locale -a</code></pre>
<p>add the locales you want (for example ru):</p>
<pre><code>sudo locale-gen ru_RU
sudo locale-gen ru_RU.UTF-8</code></pre>
<p>run this update command</p>
<pre><code>sudo update-locale </code></pre>
</div>
<div id="os-version-and-system-name" class="section level2">
<h2>OS version and system name</h2>
<p>OS release</p>
<pre><code>cat /etc/os-release </code></pre>
<p>System name</p>
<pre><code>uname -a

file /sbin/init

hostname -f </code></pre>
</div>
<div id="partitioning-and-formatting-drives" class="section level2">
<h2>Partitioning and formatting drives</h2>
<p>Manipulate the disk partition table <a
href="https://ubuntuforums.org/archive/index.php/t-2030703.html">See
forum post July 21st, 2012, 09:08 AM</a></p>
<pre><code>sudo fdisk /dev/sdb
d # delete
w # write table to disk
sudo fdisk /dev/sdb
n # create a new partition
# yes to all default choices
w # write table to disk</code></pre>
<p>Create a MS-DOS file system for USB drives</p>
<pre><code>mkfs.vfat -n &#39;usb_drive_name&#39; -I /dev/sdb1</code></pre>
<p>You can also use the GUI gparted.</p>
<div id="format-a-usb-drive" class="section level3">
<h3>Format a USB drive</h3>
<p>Format a USB drive as a FAT 32 partition.</p>
<pre><code>sudo fdisk -l 
sudo umount /dev/mmcblk0p1 
sudo mkdosfs -F 32 -I /dev/mmcblk0</code></pre>
<p>format a USB drive as a FAT 32 partition smaller than the drive
size</p>
<pre><code>sudo mkdosfs -I -F 32 /dev/mmcblk0 $((2*1024*1024))</code></pre>
<p>I used the GUI tool Gparted. To see if a partition is primary, use
the command: sudo parted /dev/mmcblk0 # then: print</p>
<p>This will print the type (primary or logical) of the partition.</p>
</div>
</div>
<div id="user-activity" class="section level2">
<h2>User activity</h2>
<div id="monitor-user-activity" class="section level3">
<h3>Monitor user activity</h3>
<p>Last time the system was started</p>
<pre><code>last reboot 
last</code></pre>
</div>
<div id="super-user" class="section level3">
<h3>Super user</h3>
<p>Start and quit a super user session</p>
<pre><code>su
exit </code></pre>
</div>
</div>
</div>
<div id="terminal-multiplexers" class="section level1">
<h1>Terminal multiplexers</h1>
<p>Superuser.com <a
href="https://superuser.com/questions/236158/tmux-vs-screen">tmux or
screen</a></p>
<div id="screen" class="section level2">
<h2>Screen</h2>
<p>I used screen to detach and reattach bash sessions on remote hosts.
This enabled me to run long algorithms on the remote host. I could
disconnect in the evening from the ssh session and reconnect the
following morning to check if the algorithm had finished running. The
advantage of screen is that it is old and available on many systems.</p>
</div>
<div id="tmux" class="section level2">
<h2>Tmux</h2>
<p>Tmux is under more active development than Screen.</p>
<ul>
<li><a href="https://robots.thoughtbot.com/a-tmux-crash-course">Crash
course</a></li>
<li><a href="https://gist.github.com/MohamedAlaa/2961058">shortcuts and
cheat sheet</a></li>
</ul>
<div id="sessions" class="section level3">
<h3>Sessions</h3>
<p>To start a session</p>
<pre><code>tmux</code></pre>
<p>To start and name a session:</p>
<pre><code>tmux new -s session_name</code></pre>
<p>To detach from a session:</p>
<pre><code>tmux detach (CTRL + b + d)</code></pre>
<p>To reattach to a session:</p>
<pre><code>tmux attach -t session_name</code></pre>
<p>If there is only one session it’s enough to call</p>
<pre><code>tmux attach</code></pre>
<p>To list current sessions:</p>
<pre><code>tmux list-sessions</code></pre>
<p>To switch to another session:</p>
<pre><code>tmux switch -t session_name</code></pre>
<p>To delete a session:</p>
<pre><code>tmux kill-session -t targetSession</code></pre>
</div>
<div id="windows-tabs" class="section level3">
<h3>Windows (tabs)</h3>
<p>Create a new windows</p>
<pre><code>tmux new-window (CTRL + b + c)</code></pre>
<p>Move to a window</p>
<pre><code>tmux select-window -t :0-9 (CTRL + b + 0-9)</code></pre>
<p>Rename the current window</p>
<pre><code>tmux rename-window (CTRL + b + ,)</code></pre>
</div>
<div id="panes-splits" class="section level3">
<h3>Panes (splits)</h3>
<p>Following commands should be prefixed by <code>CTRL + b</code>.</p>
<p>Vertical split</p>
<pre><code>%</code></pre>
<p>Horizontal split</p>
<pre><code>&quot;</code></pre>
<p>Kill a pane</p>
<pre><code>x</code></pre>
<p>Display pane numbers</p>
<pre><code>q</code></pre>
<p><a href="https://unix.stackexchange.com/a/136643/85530">How to switch
directly to a pane in tmux?</a>:</p>
<blockquote>
<p>“You can jump directly to a pane by typing pane’s index while it is
showed by display panes command.”</p>
</blockquote>
<p>Zoom a pane and de-zoom it:</p>
<p>z</p>
<p>Swap pane up and down or left and right</p>
<pre><code>{
}</code></pre>
<p>Bind the s key to create a small split window at the bottom of the
screen</p>
<pre><code>bind-key s split-window -v \; resize-pane -y 2</code></pre>
<p>Uses an escaped semi colon to separate the two commands <a
href="https://superuser.com/questions/352117/binding-a-tmux-key-to-multiple-commands">as
explained on super user</a>.</p>
</div>
<div id="movements" class="section level3">
<h3>Movements</h3>
<p>To scroll inside a pane press</p>
<pre><code>CTRL + b + Page up down</code></pre>
</div>
<div id="tmux-configuration" class="section level3">
<h3>tmux configuration</h3>
<p><a href="https://stackoverflow.com/a/21033340/2641825">This
answer</a> explains how to create a tmux source-file. The configuration
file tells tmux to create windows and panes and to start programs in
each one of them. I started to create a tmux source file to start my
favorite programs: A particular setup I use forces me to start these GUI
programs from a command line:</p>
<pre><code>neww
split-window -v &#39;lyx&#39;  
split-window -v &#39;jabref&#39;  
split-window -h &#39;rstudio&#39; 
new-window</code></pre>
<p>Start tmux with this configuration file:</p>
<pre><code>tmux new-session -s work &quot;tmux source-file ~/.tmux/work&quot;      </code></pre>
<p>Make it a bash alias, by adding the following line to ~/.bashrc:</p>
<pre><code>alias tmuxw=&#39;tmux new-session -s work &quot;tmux source-file ~/.tmux/work&quot;&#39;</code></pre>
<p>Reddit <a
href="https://www.reddit.com/r/vim/comments/600frr/tmux_tabs_splits_workflow/">discussion
on vim splits and tmux tabs</a></p>
<p>Reload the tmux configuration file</p>
<pre><code>source-file ~/.tmux.conf</code></pre>
</div>
<div id="vim-and-tmux-navigation" class="section level3">
<h3>VIM and TMUX Navigation</h3>
<ul>
<li><p><a href="https://github.com/christoomey/vim-tmux-navigator">VIM
and TMUX navigator</a></p></li>
<li><p><a
href="https://robots.thoughtbot.com/seamlessly-navigate-vim-and-tmux-splits">Seamlessly
navigate VIM and TMUX splits</a></p></li>
</ul>
<p>I simply copie the tmux side of the configuration here:</p>
<p>Smart pane switching with awareness of Vim splits. See: <a
href="https://github.com/christoomey/vim-tmux-navigator"
class="uri">https://github.com/christoomey/vim-tmux-navigator</a></p>
<pre><code>is_vim=&quot;ps -o state= -o comm= -t &#39;#{pane_tty}&#39; \
    | grep -iqE &#39;^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$&#39;&quot;
bind-key -n &#39;C-h&#39; if-shell &quot;$is_vim&quot; &#39;send-keys C-h&#39;  &#39;select-pane -L&#39;
bind-key -n &#39;C-j&#39; if-shell &quot;$is_vim&quot; &#39;send-keys C-j&#39;  &#39;select-pane -D&#39;
bind-key -n &#39;C-k&#39; if-shell &quot;$is_vim&quot; &#39;send-keys C-k&#39;  &#39;select-pane -U&#39;
bind-key -n &#39;C-l&#39; if-shell &quot;$is_vim&quot; &#39;send-keys C-l&#39;  &#39;select-pane -R&#39;</code></pre>
</div>
</div>
</div>
<div id="time" class="section level1">
<h1>Time</h1>
<div id="current-date" class="section level2">
<h2>Current date</h2>
<p>Display the current data</p>
<pre><code>date</code></pre>
</div>
<div id="countdown-timer" class="section level2">
<h2>Countdown timer</h2>
<p>A <a
href="https://superuser.com/questions/611538/is-there-a-way-to-display-a-countdown-or-stopwatch-timer-in-a-terminal">superuser
question</a> gives a basic loop</p>
<pre><code>N=100; while [[ $((--N)) &gt;  0 ]]; do echo $N &amp;&amp; sleep 1; done</code></pre>
<p>There are many more elaborate answers under that question. One of
them suggests the python based termdown</p>
<pre><code>pip3 install termdown
termdown 10
termdown 25m</code></pre>
</div>
</div>
<div id="users" class="section level1">
<h1>Users</h1>
<div id="manage-users-and-groups" class="section level2">
<h2>Manage users and groups</h2>
<p>Check your user id</p>
<pre><code>id 
echo $UID
echo $USER</code></pre>
<p>What group do you belong to as a user</p>
<pre><code>groups</code></pre>
<p>Add a new user</p>
<pre><code>useradd username</code></pre>
<p>Set a password for the new user</p>
<pre><code>passwd username </code></pre>
<p>Delete a user</p>
<pre><code>userdel username</code></pre>
<p>Temporary log in as a given user</p>
<pre><code>su username</code></pre>
<p>Add a user to the super users</p>
<pre><code>adduser username sudo</code></pre>
<p>That user needs to re-log into the shell for the change to take
effect.</p>
<p>Show all users</p>
<pre><code>getent passwd</code></pre>
<p>Show all groups</p>
<pre><code>getent group </code></pre>
</div>
<div id="list-users-and-groups" class="section level2">
<h2>List users and groups</h2>
<p>List all users</p>
<pre><code>less /etc/passwd</code></pre>
<p>List all groups</p>
<pre><code>less /etc/group
getent group</code></pre>
<p>List all groups a user is a member of</p>
<pre><code>groups paul</code></pre>
<p>List all members of a group</p>
<pre><code>getent group www-data
getent group sudo</code></pre>
</div>
<div id="change-file-permission" class="section level2">
<h2>Change file permission</h2>
<p>Change user and group of a file</p>
<pre><code>chown groupname:username filename</code></pre>
<p>Change user and group of all files in a folder, recursively</p>
<pre><code># In one command
sudo chown -R paul:paul scenarios
# In two commands
sudo chown -R paul scenarios
sudo chgrp -R paul scenarios</code></pre>
<p>Change file permission</p>
<pre><code>chmod a=rwx filename
chmod 777 filename # all permissions to every one</code></pre>
<p>Change file permissions recursively:</p>
<pre><code>chmod 755 directoryname # all permissions to the user, only read and execute for other users
sudo chmod -R 770 scenarios</code></pre>
<p><a href="https://stackoverflow.com/a/58449179/2641825">nice
illustration</a> of read, write execute permission codes on Linux.</p>
<p>Chmod instructions can be given with characters or numbers, chmod 777
or chmod a=rwx is a question of preference.</p>
<pre><code>Some prefer 755 over 777 because giving write access to group and other users could be a security risk. 755 leaves read and execute rights to groups and other users. 755 is visible as &quot;rwxr-xr-x&quot; in ls -l. 
The default for document files on Debian seems to be chmod 644, visible as &quot;-rw-r--r--&quot; in ls -l.</code></pre>
</div>
<div id="make-the-bash-shell-by-default-for-a-user"
class="section level2">
<h2>Make the bash shell by default for a user</h2>
<p><a
href="https://superuser.com/questions/904425/no-path-or-command-history-through-ssh-when-logged-in-to-server-as-someone-othe/904485#904485">No
path, or command history through SSH when logged in to server as someone
other than root</a></p>
<p>Edit the users file</p>
<pre><code>sudo vim /etc/passwd</code></pre>
<p>Change</p>
<pre><code>paul:x:1000:1000::/home/paul:/bin/sh</code></pre>
<p>to</p>
<pre><code>paul:x:1000:1000::/home/paul:/bin/bash</code></pre>
</div>
</div>
<div id="vpn" class="section level1">
<h1>VPN</h1>
<p>A VPN was useful when:</p>
<ul>
<li>SMS interface didn’t work on orange.fr. I could access it through a
VPN server based in Paris.</li>
<li>FTP download site based in Canada didn’t work from Italy. A
colleague could access it through a VPN server based in Canada.</li>
<li>SSH access to remote servers didn’t work on company wifi. I could
access the machines through the VPN.</li>
</ul>
<p>VPN access also removes localisation of site searches on google and
google maps.</p>
<p>Example session,from a company wifi system which is probably blocking
SSH traffic. The SSH connection breaks:</p>
<pre><code>paul@debian:~/repos$ ssh host 
ssh_exchange_identification: Connection closed by remote host</code></pre>
<p>I start the VPN:</p>
<pre><code>paul@debian:~/repos$ vpn connect
Connecting to France - Paris - 1...     100.0%                       
Connected to France - Paris - 1</code></pre>
<p>I try to reconnect to that server through SSH:</p>
<pre><code>paul@debian:~/repos$ ssh host 
The authenticity of host &#39;[.......eu-west-1.compute.amazonaws.com] ([__IP__])&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:PTwO1p7Q3XqPE4Gs+KH37XqH88ePDYh5bNqKXyVpGAE.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;[......eu-west-1.compute.amazonaws.com],[....]&#39; (ECDSA) to the list of known hosts.</code></pre>
<p>Now the connection works.</p>
<p>Some VPN access points caused issues when connecting to the corporate
email server and intranet. The connection was blocked for the access
point in Milan, Italy. It did work when using the access point in
Strasbourg, France.</p>
<p>The access point from Strasbourg prevented access to Elsevier
publications. With the message: &gt; “There was a problem providing the
content you requested”</p>
<p>I complained to <a href="mailto:nlinfo@elsevier.com"
class="email">nlinfo@elsevier.com</a> and received the following
message::</p>
<blockquote>
<p>Dear Paul Thank you for your patience. My colleagues have informed me
that the IP &lt;………….&gt; where you are accessing from has been tagged
with high amount of retrieving content from ScienceDirect.</p>
</blockquote>
<blockquote>
<p>We do understand that your purpose of downloading and searching of
content is for personal, non-commercial or scholarly use and it is
difficult to be getting warnings every time you download content from
the site. Please be advised that Elsevier cares about the integrity of
our product and ensure data protection. With this, ScienceDirect
continuously monitor signals of excessive downloading of content thus
explains the warning you might have encountered. Please note as well
that only the IP has been tagged and this concern may be resolved by
using a different IP network.</p>
</blockquote>
<blockquote>
<p>Please reach out to your institution’s or organization’s
administrator or librarian for an alternate access in ScienceDirect.</p>
</blockquote>
<blockquote>
<p>Thank you for your understanding. Please feel free to message us if
you have any questions or require further assistance.</p>
</blockquote>
<p>Changing the VPN location to Frankfurt allowed me to see these
Elsevier publications again.</p>
<div id="vpn-software" class="section level2">
<h2>VPN software</h2>
<p><a href="https://www.wireguard.com/">wireguard</a> wikipedia article
<a href="https://en.wikipedia.org/wiki/WireGuard">wireguard</a></p>
<p>Service providers</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
