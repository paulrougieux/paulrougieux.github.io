---
title: "Debian GNU/Linux Operation System"
output: 
  html_document: 
    toc: yes
    toc_float: true
---

This page is the continuation of 
[several blog posts related to Debian](https://paulremote.blogspot.fr/search/label/Debian)

# Installing Debian 

The Debian GNU Linux operating system is available as a torrent download or a
http download at [debian.org/CD](https://www.debian.org/CD/): 

* The [net install CD](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/) 
  is sufficient to install Debian.
* On [debian.org/CD/live/](https://www.debian.org/CD/live/) you can get 
   "Live images which you can use to try Debian first 
   and then install the contents of the image."

Verify the checksum 

    shasum debian-10.1.0-amd64-netinst.iso

To copy the image to a usb key follow the 
[instruction on how to copy the iso image to a usb key](https://www.debian.org/releases/stable/amd64/ch04s03.html.en) 

Find the device name of my USB key (it had a previous Debian system on it):

    sudo fdisk -l
    # /dev/sdb1 

Unmount the USB key

    sudo umount /dev/sdb1
    # or
    sudo umount "/media/gabriele/Debian Inst"
    # or
    sudo umount "/media/paul/Debian 10.1.0 amd64 n"

Transfer the iso image to the key

   sudo cp debian-live-9.5.0-amd64-gnome.iso /dev/sdb
   # or
   sudo cp debian-10.1.0-amd64-netinst.iso  /dev/sdb

The iso should be copied to `sdb` and not to `sdb1` !
Then the USB drive can be used to boot a laptop. 


## After the installation

Add my user name to the super user group

    su
    # Then as a super user 
    /usr/sbin/adduser paul sudo

I updated the debian mirror to a nearby mirror 

    sudo apt edit-sources

## Debian on a HP Elitbook

Note: on a HP laptop make sure that the "legacy boot" is enabled 
and that the "secure boot" is disabled. On another HP laptop, I had to disable
the fast boot so that I could boot from a USB device.
The boot devices can be chosen by pressing ESC at start up, then F9.

Debian installation went smoothly. 

After the installation, 
there was one issue with the wifi card having a non-free driver.
I had to place the package 
[firmware-iwlwifi](https://packages.debian.org/stretch/firmware-iwlwifi)
on a USB key. 
The download link is at the bottom of the page ([all](https://packages.debian.org/stretch/all/firmware-iwlwifi/download).
Then installed it from the usb key with 

    sudo apt install ./firmware-iwlwifi_20161130-3_all.deb

Alternatively, the .ucode file can also be found in 
[firmware-nonfree_20161130.orig.tar.xz](http://http.debian.net/debian/pool/non-free/f/firmware-nonfree/firmware-nonfree_20161130.orig.tar.xz)
And given directly during the installation step.

After that extra step, the wifi card was working inside Debian.


See also my 2014 blog post :
[Debian GNU Linux installation on a LENOVO T400](https://paulremote.blogspot.com/2014/05/debian-gnu-linux-installation.html)


"BootDevice Not Found" issue in a HP Elitebook:
[Grub-EFI reinstall](https://wiki.debian.org/GrubEFIReinstall)
The issue happenned on a partitionned disk. 
The fix was to completely erase the main disk and to reinstall a new debian on a single partition. 


### Screen rotation issue

[Debian / Gnome: disable sensor-based screen rotation](https://unix.stackexchange.com/a/381398/85530)

    gsettings set org.gnome.settings-daemon.peripherals.touchscreen orientation-lock true

or use lock orientation in the dash. But this doesn't solve the issue on the home screen.

[Screen rotation in Ubuntu 18.04](https://askubuntu.com/a/1054060)
Also mentioned in [reddit incorrect display orientation after bootup](https://www.reddit.com/r/gnome/comments/6ndc8d/incorrect_display_orientation_after_bootup/)

    gsettings set org.gnome.settings-daemon.plugins.orientation active false

[Also after boot](https://unix.stackexchange.com/a/518564/85530)

Edit this file:

    vim  /etc/udev/hwdb.d/60-sensor.hwdb 

The default matrix is:

    sensor:modalias:*
          ACCEL_MOUNT_MATRIX=1, 0, 0; 0, 1, 0; 0, 0, 1

I used this setting to fix the orientation of an HP Elitebook laptop.

    sensor:modalias:*
      ACCEL_MOUNT_MATRIX=0, 1, 0; 1, 0, 0; 0, 0, 1


# Debian Development

* [Debian Salsa](https://salsa.debian.org/public) code repository.

## Documentation

* [wiki.debian.org](https://wiki.debian.org/)

# Installing software

## APT

For software in the repository, use

    sudo apt install packagename


### APT behind a proxy

[Hash sum mismatch issue, fix bad proxy](https://askubuntu.com/a/809808/315347)

    sudo vim /etc/apt/apt.conf.d/99fixbadproxy

Enter: 

	Acquire::http::Pipeline-Depth 0;
	Acquire::http::No-Cache true;
	Acquire::BrokenProxy    true;

Now run the update command:

    sudo apt update


[How to set the proxy for APT](https://www.serverlab.ca/tutorials/linux/administration-linux/how-to-set-the-proxy-for-apt-for-ubuntu-18-04/)
I entered the proxy url in this apt configuration file: 

    vim /etc/apt/apt.conf.d/proxy.conf

In the following form (do not forget the semicolon at the end):

    Acquire::http::Proxy "http://user:password@proxy.server:port/";




## Installing Debian software from backports


[backports.debian.org](https://backports.debian.org/) contains a list of backports available for each LTS Debian version.

Add the main, contrib and non-free backports to /etc/apt/sources.list :

    deb http://ftp.it.debian.org/debian stretch-backports main contrib non-free

Install from backports

    sudo apt -t stretch-backports install nodejs


## DEB packages

For software in .deb packages, check the md5sum and install with

    md5sum packagename.deb
    sudo dpkg -i packagename.deb

or 

    sudo apt install ./packagename.deb

Stack overflow [How to install a deb file, by dpkg -i or by apt?](https://unix.stackexchange.com/a/159114/85530)
"When you use apt to install a package, under the hood it uses dpkg."


If there are missingdependencies and you fix them you can retry the previsouly failed installed with:
    sudo dpkg --configure -a

Remove a package with:

    sudo dpkg -r packagename


## Anbox

[Android in a box](https://anbox.io/)
is an android emulator that runs on Linux. 
To install it on debian I added the contrib and non-free backports to /etc/apt/sources.list :

    deb http://ftp.it.debian.org/debian stretch-backports main contrib non-free

Then installed anbox from the backports:

    sudo apt -t stretch-backports install anbox

I have encountered [issue 211](https://github.com/anbox/anbox/issues/211)

## CEWE Photobuch

Download one of the setup files from CEWE or partner shops
`setup_CEWE_FOTOWELT.tgz`, `setup_CEWE_Photoworld.tgz`, `setup_dm_Fotowelt.tgz`
Extract it :

    tar --extract -f setup_CEWE_FOTOWELT.tgz --one-top-level

Launch the installer (no need to be sudo):

    cd setup_CEWE_FOTOWELT/
    ./install.pl 

## Lyx

wiki.lyx.org [LyXOnDebian](https://wiki.lyx.org/LyX/LyXOnDebian) 
explains how to install Lyx on Debian:

    sudo apt install lyx

Lyx couldn't access some layout files, I first thought I needed install latex layouts:

    sudo apt install texlive-latex-recommended
    sudo apt install texlive-latex-extra

But these were already installed. 

Default version of Lyx is 2.2 on debian strech.
wiki.lyx.org [LyXOnDebian](https://wiki.lyx.org/LyX/LyXOnDebian) 
explains how to install lyx 2.3 from the backports on Debian stretch. 

    sudo vim /etc/apt/sources.list
    # Add deb http://ftp.debian.org/debian stretch-backports main 
    # Or a mirror, for example
    # deb http://ftp.it.debian.org/debian stretch-backports main
    sudo apt update
    sudo apt-get -t stretch-backports install lyx


## Mutt and Neomutt

packages.debian.org [Neomutt](https://packages.debian.org/buster/neomutt) 

The Arch Linux [setup
page](https://wiki.archlinux.org/index.php/Mutt#Installation) explains that : 

> "The NeoMutt project aims to bring together all the patches for Mutt. It adds
> a large set of features. Lots of old Mutt patches have been brought
> up-to-date, tidied and documented."

It also has a section on setting up the vim editor with Mutt.

[How do I set up posteo in an email 
client?](https://posteo.de/en/help/how-do-i-set-up-posteo-in-an-email-client-pop3-imap-and-smtp)

Mutt configuration example [in a
dotfile](https://github.com/manuel-io/dotfiles/blob/master/muttrc) with
connection to posteo and vim editor.

Example of Mutt setup for professional email coming from an Exchange server. 


## Python

Install editor

    pip3 install spyder

## R and Rstudio

### Installing R from the CRAN mirror

Install R from the CRAN repository,
see [Cran mirror of Debian packages](https://cran.r-project.org/bin/linux/debian/#debian-stretch-stable)

Add the following to /etc/apt/sources.list

    deb https://cran.stat.unipd.it/bin/linux/debian buster-cran35/

In case you get an error:

    The following signatures couldn't be verified because the public key is not available: NO_PUBKEY FCAE2A0E115C3D8A

Add the PGP key so that this server is trusted :

    sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-key 'FCAE2A0E115C3D8A'

Based on this stackoverflow answer 
[about key server receive fail error](https://unix.stackexchange.com/a/110594/85530)
I had to use a server providing a connection on port 80 because the default port is 
apparently blocked by a firewall on my network.

Then run the following to upgrade R to the lastest version availale on your CRAN mirror:

    sudo apt update
    sudo apt install r-base r-base-dev

Or if you already had an old R version on your system:

    sudo apt upgrade 

### Installing Rstudio

Download Rstudio for Debian 

 * [Rstudio download](https://www.rstudio.com/products/rstudio/download/preview/)
 * [Rstudio preview download](https://www.rstudio.com/products/rstudio/download/preview/)

Run 

    dpkg -i rstudio-version-number.deb

Dependency error: rstudio depends on libclang-dev
Install it 

    sudo apt install libclang-dev

[Uninstall rstudio](https://support.rstudio.com/hc/en-us/articles/200554736-How-To-Uninstall-RStudio-Desktop)

    sudo apt remove rstudio

## Remmina

Installing from the backports (see above section on how to add the backports in sources.list)

    sudo apt-get -t stretch-backports install remmina 


## Riot

[Desktop Riot installation](https://riot.im/download/desktop/)

    sudo apt install -y lsb-release wget apt-transport-https
    sudo wget -O /usr/share/keyrings/riot-im-archive-keyring.gpg https://packages.riot.im/debian/riot-im-archive-keyring.gpg
    echo "deb [signed-by=/usr/share/keyrings/riot-im-archive-keyring.gpg] https://packages.riot.im/debian/ $(lsb_release -cs) main" |
        sudo tee /etc/apt/sources.list.d/riot-im.list
    sudo apt update
    sudo apt install riot-web

In an earlier version riot the source.list was mentionned directly in /etc/apt/sources.list.
I needed to remove it as explained [here](https://github.com/vector-im/riot-web/issues/10278#issuecomment-509365818):

> "You have riot.im/packages in your apt sources list somewhere, which is the old repository location. You need to remove that"



## Microsoft

Yes I know, these software shouldn't be here, but I have to use these things for work and
study.

### Skype

Debian wiki [skype](https://wiki.debian.org/skype):
Download .deb file from https://www.skype.com/en/get-skype/

    wget https://go.skype.com/skypeforlinux-64.deb

Install

    sudo apt install ./skypeforlinux-64.deb

### Teams

[Donwload teams from
microsoft](https://www.microsoft.com/en-gb/microsoft-365/microsoft-teams/download-app#desktopAppDownloadregion)

Install 

    sudo apt install ./teams_1.3.00.25560_amd64.deb

[Microphone stopped working in
teams](https://docs.microsoft.com/en-us/answers/questions/99254/microphone-stopped-working-with-teams-130016851-64.html)
I had a sound issue. I managed to reactivate the sound under Debian settings /
sound / applications there by reactivating the sound for cmus this somehow also
affected teams and I could hear the audio again in teams after that. Or maybe I
also change the settings for Skype? In any case I have sound again in teams
now. Yes, after looking at another laptop with teams only (no Skype) I'm sure
that teams appears as "Skype" in that Debian settings / sound / applications
menu. 

## Vim 

Edit the keyboard configuration as explained in 
[mapping caps lock to escape in Debian]
(https://martin.hoppenheit.info/blog/2014/mapping-caps-lock-to-escape-in-debian/)

   sudo vim /etc/default/keyboard

Add the following line to that file:

    XKBOPTIONS="caps:escape"


## VPN 

### ExpressVPN

Download the software and signature file

    cat expressvpn_3.3.0.21-1_amd64.deb.asc

[Check the
signature](https://www.expressvpn.com/support/vpn-setup/pgp-for-linux/)

    gpg --keyserver hkp://keyserver.ubuntu.com --recv-keys 0xAFF2A1415F6A3A38
    gpg --fingerprint release@expressvpn.com
    gpg --verify expressvpn_3.3.0.21-1_amd64.deb.asc

Install 

    sudo apt install ./expressvpn_3.3.0.21-1_amd64.deb


## Wajig

Debian and ubuntu system administration [wajig docs](https://wajig.readthedocs.io/en/latest/)

## Zathura

Usage

    Tab    Show index and switch to Index mode

The configuration file is located at ~/.config/zathura/zathurarc.
More information in `man zathurarc`.

[Invert color](https://www.noudaldenhoven.nl/wordpress/?p=166)
is map to Ctrl+r by default, to map it to Ctrl+i, 
edit the configuration file 

    map <C-i> recolor

[Copy to
clipboard](https://unix.stackexchange.com/questions/339487/how-to-enable-copy-to-clipboard-with-zathura-pdf-poppler)
(instead of middle mouse button clipboard)

    set selection-clipboard clipboard

Scroll

    set scroll-full-overlap 0.08


## Zoom

[Zoom install on
Linux](https://support.zoom.us/hc/en-us/articles/204206269-Installing-Zoom-on-Linux#h_adcc0b66-b2f4-468b-bc7a-12c182f354b7)

    cd downloads/
    rm zoom_amd64.deb
    wget https://zoom.us/client/latest/zoom_amd64.deb

    # Check public key fingerprint
    rm ~/downloads/pubkey
    wget https://zoom.us/linux/download/pubkey
    cat pubkey | gpg --import-options show-only --import

    # Install
    sudo apt install ./zoom_amd64.deb 

# Audio

## Audio Setup

## Audio Issues
"dummy output" issue.
Seen on a [Debian Forum](http://forums.debian.net/viewtopic.php?f=7&t=104263) one of the answer to 
Pulse Audio shows "dummy output" linked to that KDE PulseAudio page:
[KDE PulseAudio Integration](https://www.freedesktop.org/wiki/Software/PulseAudio/Desktops/KDE/)
"One thing that can happen is that some other process "hogs" the audio device during PulseAudio startup. When this happens PA is unable to use the device until it is restarted. If PA is unable to open your hardware, you will automatically be given a "Dummy Output". As the name suggests, anything that is "Played" via this device is inaudible). This "Dummy Output" should be easily visible in both KMix and Phonon. If this happens, then you can debug which process is hogging the hardware via the command: sudo lsof /dev/snd/* /dev/dsp* (Note that apps which have the /dev/snd/control* devices open are unlikely to interfere)."

Debian wiki [Missing playback devices or audio capture](https://wiki.debian.org/PulseAudio#Missing_playback_devices_or_audio_capture)
deleting the configuration files and restarting pulseaudio. 
The following commands restored audio:

    $ rm -r ~/.config/pulse /tmp/pulse-*
    $ pulseaudio --kill
    $ pulseaudio --start

## Media keys

Some keyboards have media keys stop, previous, play/pause, next. 
I'd like to remap them to play pause in cmus.
In the mean time I have set 'Ctrl+Shift+P' as a shortcut in settings/keyboard, '+' at the bottom:

    cmus-remote --pause

# Fonts

Some programs require fonts that are not installed by default. 
For example:

    sudo apt install fonts-crosextra-carlito fonts-crosextra-caladea
    sudo apt install fonts-deva-extra

[List of missing fonts](https://wiki.debian.org/Fonts/Missing)
[SubstitutingCalibriAndCambriaFonts](https://wiki.debian.org/SubstitutingCalibriAndCambriaFonts)


# Gnome

[Gnome shell pressing the super key does not
work](https://askubuntu.com/questions/69648/gnome-shell-pressing-the-super-key-does-not-work/1179193#1179193)

> "You might have locked your super button.
> Try unlock it on your keyboard. It usually has two icons - a window key and a lock."

There is indeed a lock on my mechanical keyboard if I unlock it, the super
key works again.


# Keyboard

* [A better AZERTY for developers](https://github.com/r03/azerty)

# Network

Sometimes helps with WiFi connection.
Restart network interface: 

    sudo service network-manager restart

Or

    sudo systemctl restart NetworkManager

[Differences between systemctl and service commands](https://askubuntu.com/questions/903354/difference-between-systemctl-and-service-commands). 
[What is the difference between service and systemctl](https://serverfault.com/questions/867322/what-is-the-difference-between-service-and-systemctl)
> "[...], service is designed as a high-level wrapper to "abstract" out various service managers like init.d, initctl, and (of course) systemctl."

# Mouse and Touchpad

Under Gnome Settings / Mouse and Touchpad, I set Natural scrolling off under
the mouse and the touchpad sections. 

# Printer

[Disable automatic remote printer installation](https://askubuntu.com/questions/345083/how-do-i-disable-automatic-remote-printer-installation)

# Screen display

The issue is that sometimes the display menu doesn't provide all resolutions
available for a given additional screen. Typically resolution suggested are
lower than the one recommended by the screen. 

## Wayland

### Make another screen resolution available
Ask Ubuntu [Adding a custom resolution with
Wayland](https://askubuntu.com/a/973582) I tried [this
answer](https://askubuntu.com/a/1210275/315347) and added this to the kernel
boot parameter. Note from ubuntu wiki [kernel boot
parameter](https://wiki.ubuntu.com/Kernel/KernelBootParameters) "Be sure to add
a SPACE after "splash" before adding your new parameter.) Click the Save
button, then close the editor window. "

    sudo vim /etc/default/grub

Then edit this line

    GRUB_CMDLINE_LINUX_DEFAULT="quiet video=DP-2:1920x1200@60"

Then update grub

    sudo update-grub

This did make the new resolution available in the Gnome display settings. 

## Custom wrapper script for x11
Debian 10 Buster uses wayland as a
window manager. To force the use of x11 for zathura, in debian a zathura
wrapper script containing:

    #!/usr/bin/bash
    GDK_BACKEND=x11 /usr/bin/zathura "$@"

Can be placed under the default user bin located at ~/.local/bin.
This is one of the first element of the `$PATH` environment variable. 


## Outdated solution using xrandr

[xrandr doesn't work with Wayland](https://forums.fedoraforum.org/showthread.php?312000-Wayland-xrandr-equivalent)
Askubuntu [wrandr will not work with wayland](https://askubuntu.com/a/973582)
The information on setting a resolution with cvt is still relevant.
CVT calculates VESA CVT mode lines.

[How to force screen resolution in
Ubuntu and make it
permanent](https://www.ma-no.org/en/software/how-to-force-screen-s-resolution-in-ubuntu-and-make-it-permanent)
The lack of auto detection of the available resolution probably mostly arises with
VGA ports. See all active screens with the RandR extension:

    xrandr

Create a new resolution using cvt :

    cvt 1920 1200 60
    # 1920x1200 59.88 Hz (CVT 2.30MA) hsync: 74.56 kHz; pclk: 193.25 MHz
    # Modeline "1920x1200_60.00"  193.25  1920 2056 2256 2592  1200 1203 1209 1245 -hsync +vsync

Use the output of the cvt command to create a new mode 

    sudo xrandr --newmode "1920x1200_60.00"  193.25  1920 2056 2256 2592  1200 1203 1209 1245 -hsync +vsync

An [askubuntu answer](https://askubuntu.com/a/448113) suggests the same command without sudo.

Find the display

    xrandr | grep -e " connected [^(]" | sed -e "s/\([A-Z0-9]\+\) connected.*/\1/"

Add new display mode where is the output from the previous command

    xrandr --addmode XWAYLAND1 1920x1200_60.00

This will add the new resolution to your existing list of supported
resolutions. You can then choose the right option from the "display settings"
or following command  

    xrandr --output XWAYLAND1 --mode "1920x1200_60.00"

# System information

Find out which Debian version is running

    cat /etc/issue

Display the OS release

    cat /etc/os-release 

# Tools

These tools are not specific to Debian. I place them here because 
I use Debian as my main system. If a section gets too large it may get
moved to another page in the future. 

## Gimp

The most important Gimp shortcuts are: 

 * CTRL + B to open the tool Box
 * CTRL + L to open the Layers dialog

A [list of Gimp Shortcuts](http://gimptips.com/articles/gimp-keyboard-shortcuts)

# Upgrade Debian version

## From Jessie 8 to Stretch 9
I followed the documentation on 
[upgrades from Debian 8, Jessie](https://www.debian.org/releases/stable/amd64/release-notes/ch-upgrading.html)

In bash store the output of apt-get install with many dependency issues in a text file

    $ sudo apt-get -f install > aptgetfinstall.txt

Using R to extract  all packages and try to remove them

    R> bli <- readLines("aptgetfinstall;txt")
    R> blil <- strsplit(grep("^ [[:alpha:]]", bli, value=TRUE),":")
    R> pkgissues <- unlist(lapply(blil, "[[", 1))

The bash command to remove a package was

    $ sudo dpkg --force-all -P <packagename>

Send this command for all packages

    R> lapply(paste("sudo dpkg --force-all -P ", pkgissues),system)



## From stretch 9 to buster 10

* debian.org [buster upgrading](https://www.debian.org/releases/buster/amd64/release-notes/ch-upgrading)
* tecadmin.net [upgrade debian 9 to debian 10 buster](https://tecadmin.net/upgrade-debian-9-to-debian-10-buster/)

    sudo apt update 
    sudo apt upgrade

Edit the sources.list files to replace "stretch" by "buster"

    sudo vim /etc/apt/sources.list
    # in vim :%s/stretch/buster/g

Attention, I had another sources.list file under a subdirectory
I had to comment the sources mention there as well, otherwise the system wouldn't uprgade most packages. 

    sudo vim  /etc/apt/sources.list.d/base.list
    sudo apt update
    sudo apt upgrade
    sudo apt dist-upgrade

The update steps mentioned above worked well in October 2019, but one year
later, in October 2020 I tried to update another laptop from Debian 9 to 10 and
many Debian packages were kept back. The GNOME desktop became unstable and I
couldn't log in any longer. I could still log into the command line to make a
proper backup of all the data to a USB drive. I ended up reinstalling a fresh
version of Debian buster 10 to that laptop. The lesson I learned from this, is
that it's better to update to a new stable release pretty soon after it's
released.

[Debian releases](https://www.debian.org/releases/):
> "Debian is version 10, codenamed buster was initially released as version
> 10 on July 6th, 2019 and its latest update, version 10.6, was released on
> September 26th, 2020."

# Blogs

Uses this "A collection of nerdy interviews asking people from all walks of
life what they use to get the job done".

* [John Mac Farlane](https://usesthis.com/interviews/john.macfarlane/), the
  author of pandoc uses Debian and Vim.


